var Jt=Object.defineProperty;var Gt=(h,t,e)=>t in h?Jt(h,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):h[t]=e;var m=(h,t,e)=>Gt(h,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const g of i.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&n(g)}).observe(document,{childList:!0,subtree:!0});function e(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=e(s);fetch(s.href,i)}})();var A=(h=>(h.L="L",h.R="R",h.U="U",h.D="D",h))(A||{});class ht{constructor(t,e){this.key=t,this.value=e}getKey(){return this.key}getValue(){return this.value}static from(t,e){return new ht(t,e)}toString(){return"["+this.getKey()+", "+this.getValue()+"]"}}const bt=class bt{static makeMove(t,e){const s=t.indexOf(-1),i=this.getXY(s);let g=i.getKey(),o=i.getValue();e===A.L&&(g-=1),e===A.R&&(g+=1),e===A.U&&(o-=1),e===A.D&&(o+=1);const p=this.getIndex(g,o);if(p>15)throw console.log(t),console.log(e),bt.logBoardState(t),new Error("i1 > 15");const x=[...t],T=x[p];return x[s]=T,x[p]=-1,x}static getXY(t){const e=t%4,n=Math.floor(t/4);return ht.from(e,n)}static getIndex(t,e){return e*4+t}static _getValidMoves(t){const e=this.getXY(t);let n=Object.values(A).slice();return e.getKey()===0&&(n=n.filter(s=>s!==A.L)),e.getKey()===3&&(n=n.filter(s=>s!==A.R)),e.getValue()===0&&(n=n.filter(s=>s!==A.U)),e.getValue()===3&&(n=n.filter(s=>s!==A.D)),n}static getValidMoves(t,e){let n=this._getValidMoves(t);const s=this.getXY(t);return this.contains(e,s.getKey()-1,s.getValue())&&(n=n.filter(i=>i!=A.L)),this.contains(e,s.getKey()+1,s.getValue())&&(n=n.filter(i=>i!=A.R)),this.contains(e,s.getKey(),s.getValue()-1)&&(n=n.filter(i=>i!=A.U)),this.contains(e,s.getKey(),s.getValue()+1)&&(n=n.filter(i=>i!=A.D)),n}static contains(t,e,n){const s=this.getIndex(e,n);return t.includes(s)}static getStateAsString(t){let e=t.getBoardState(),n=t.getGoals();return this.zenGardenOn?this.getStateAsZenStoneGarden(e,n):this.__getStateAsString(e,n)}static logBoardState(t){const e=Array.from({length:16},(n,s)=>{let i;return i=t[s].toString(),i+="	",s!==0&&(s+1)%4===0&&(i+=`
`),i}).join("");console.log(e)}static __getStateAsString(t,e){return Array.from({length:16},(n,s)=>{let i;const g=t[s];return g===-1?i=D.blue("*"):e.includes(g)?i=D.red(g.toString()):e.includes(s+1)?i=D.green(g.toString()):i=g.toString(),i+="	",s!==0&&(s+1)%4===0&&(i+=`
`),i}).join("")}static getStateAsZenStoneGarden(t,e){return Array.from({length:16},(n,s)=>{let i;const g=t[s];return e.includes(g)?i="o":e.includes(s+1)?i="O":i="",i+="	",s!==0&&(s+1)%4===0&&(i+=`
`),i}).join("")}static prntState(t){let e=this.getStateAsString(t);D.prnt(e)}static prntStateV0(t){let e=this.getStateAsString(t);D.prntAtSomeElement("shadowTester",e)}static getReverseAction(t){return t===A.D?A.U:t===A.U?A.D:t===A.L?A.R:t===A.R?A.L:null}static getAction(t,e,n){const s=e.getHashCodeV2();if(t.has(s)){let i=t.get(s);if(i===void 0)throw new Error("qTable.has(hash) == true, but get(..) returned row == undefined");return i.getActionWithMaxValue(n)}else return this.getFirstPossibleAction(e,n)}static getRandomAction(t){return t.length===0&&D.prntErrorMsg("Check lessons configuration, for logic errors: The getPossibleActions function returned no action."),t.length>0?t[Math.floor(Math.random()*t.length)]:A.D}static getFirstPossibleAction(t,e){const n=this.getPossibleActions(t);if(n.length===1)return D.prntErrorMsg("Check lessons configuration, for logic errors: The getPossibleActions function returned only one action: "+n[0]),n[0];const s=n.filter(i=>i!==e);return s.length===0?(D.prntErrorMsg("Check lessons configuration, for logic errors: The getPossibleActions function returned no action."),A.D):s[0]}static getPossibleActions(t){const e=t.getBoardState().indexOf(-1),n=t.getFixedElements().map(s=>s-1);return bt.getValidMoves(e,n)}};m(bt,"zenGardenOn",!1);let C=bt;class D{static blue(t){return'<span style="color: blue;">'+t+"</span>"}static green(t){return'<span style="color: green;">'+t+"</span>"}static red(t){return'<span style="color: red;">'+t+"</span>"}static clearScreen(){const t=document.getElementById("console");t&&(t.innerHTML="")}static prntTestStep(t){this.addElementToConsoleDiv("testGameStep",t)}static prntAtSomeElement(t,e){this.addElementToConsoleDiv(t,e)}static prntStatsInfo(t){const e=document.getElementById("statsInfo");e&&(e.setAttribute("class","console-text"),e.textContent=`
`+t.toLowerCase().replace(", "," | "))}static prntErrorMsg(t){if(C.zenGardenOn)return;const e=document.getElementById("statsInfo");e&&(e.setAttribute("class","console-error-msg"),e.textContent=`
`+t)}static addElementToConsoleDiv(t,e){const n=document.getElementById(t);n?n.innerHTML=e:this.prnt(e,"color:black;",t)}static prnt(t,e="color:black;",n=null){const s=document.getElementById("console");if(s){const i=document.createElement("div");i.innerHTML=t,e&&(i.style.cssText=e),n!==null&&(i.id=n),s.appendChild(i),s.scrollTop=s.scrollHeight}}static warn(t){this.prnt(t,"color: orange;")}}const Ot=class Ot{static prnt(t,e="color: black;"){D.prnt(t,e)}static str(t,e){const n=t.toString();if(n.length>=e)return n;const s=e-n.length;return n+Ot.emptyString.substring(0,s)}static sum(t){return!t||(t=t.filter(e=>e!==0),t.length===0)?0:t.reduce((e,n)=>e+n,0)}static toString(t){return`[${Array.from(t).map(String).join(", ")}]`}static px(){return(t,e)=>t}static equalArrays(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}static shuffleArray(t){return t.sort(()=>Math.random()-.5)}static _sleep(t){return new Promise(e=>setTimeout(e,t))}static async sleep(t){await this._sleep(t)}};m(Ot,"emptyString","                                           ");let G=Ot;class zt{constructor(t){m(this,"state");m(this,"qValues");this.state=t,this.qValues=new Map}setValue(t,e){const n=C.getPossibleActions(this.state);this.qValues.size===0&&n.forEach(s=>this.qValues.set(s,0)),n.includes(t)&&this.qValues.set(t,e)}getState(){return this.state}getValue(t){return this.qValues.get(t)||0}getActionWithMaxValue(t){const e=t===null?null:this.getAction(t);if(e==null){let n=C.getPossibleActions(this.state);if(n=n.filter(s=>s!==t),n.length===0)throw console.log("reverseAction",t),C.logBoardState(this.state.boardState),D.prntErrorMsg("possibleActions.length === 0, there allways must be some action to go around.. need to debug."),new Error("possibleActions.length === 0, there allways must be some action to go around.. need to debug.");return n[0]}else return e}getAction(t){const n=Array.from(this.qValues.entries()).filter(([s])=>s!==t).reduce((s,i)=>i[1]>s[1]?i:s,[t,-1/0]);return n[1]>-1/0?n[0]:void 0}getMaxValue(){return this.qValues.size===0?0:Math.max(...Array.from(this.qValues.values()))}}class Rt{static updateQTable(t,e,n,s,i,g,o,p){let x;if(g)x=i;else{const T=this.getQValue(t,e,n),N=this.getMaxQValue(t,s);x=this.calcQValue(i,T,N,p,o)}this.addStateWithZeroValuesToQTableIfStateNotExist(t,e),this.updateQTableEntry(t,e.getHashCodeV2(),n,x)}static updateQTableEntry(t,e,n,s){var i;(i=t.get(e))==null||i.setValue(n,s)}static getMaxQValue(t,e){var s;const n=e.getHashCodeV2();return this.addStateWithZeroValuesToQTableIfStateNotExist(t,e),((s=t.get(n))==null?void 0:s.getMaxValue())??0}static getQValue(t,e,n){var i;const s=e.getHashCodeV2();return this.addStateWithZeroValuesToQTableIfStateNotExist(t,e),((i=t.get(s))==null?void 0:i.getValue(n))??0}static addStateWithZeroValuesToQTableIfStateNotExist(t,e){t.has(e.getHashCodeV2())||this.addStateWithZeroValuesToQTable(t,e)}static addStateWithZeroValuesToQTable(t,e){const n=e.getHashCodeV2(),s=new zt(e);t.set(n,s)}static calcQValue(t,e,n,s,i){return e+i*(t+s*n-e)}}class q{constructor(t,e){m(this,"boardState");m(this,"goals");m(this,"fixedElements");"boardState"in t&&"goals"in t&&"fixedElements"in t?(this.boardState=[...t.boardState],this.goals=[...t.goals],this.fixedElements=[...t.fixedElements]):t instanceof q?(this.boardState=[...t.getBoardState()],this.goals=[...t.getGoals()],this.fixedElements=[...t.getFixedElements()]):(this.boardState=[...t],this.goals=[...(e==null?void 0:e.getGoals())??[]],this.fixedElements=[...(e==null?void 0:e.getLockedStateElements())??[]])}static getTestCase(){let t={boardState:[1,2,3,4,5,6,7,8,9,10,11,-1,14,15,12,13],goals:[12],fixedElements:[1,2,3,4,5,6,7,8,9,10,11,13,14,15]};return new q(t)}getBoardState(){return this.boardState}setBoardState(t){this.boardState=t}getGoals(){return this.goals}setGoals(t){this.goals=t}getFixedElements(){return this.fixedElements}setFixedElements(t){this.fixedElements=t}getHashCodeV2(){const t=this.getHashCodeV3__();return this.hashString(t)}getHashCodeV3__(){return Array.from({length:16},(t,e)=>{let n;const s=this.boardState[e];return s===-1?n="*":this.goals.includes(s)?n=String(s):this.goals.includes(e+1)?n="o":n=" ",n=n+"	",e!==0&&(e+1)%4===0&&(n=n+`
`),n}).join("")}getHashCode(){const t=this.boardState.map(String).join(",");return this.hashString(t)}hashString(t){let e=0;for(let n=0;n<t.length;n++){const s=t.charCodeAt(n);e=(e<<5)-e+s,e|=0}return e}equals(t){return this.getHashCode()===t.getHashCode()}hashCode(){return this.getHashCode()}}class Ht{constructor(t,e,n=0,s=!1){m(this,"state");m(this,"action");m(this,"reward");m(this,"isTerminal");this.state=t,this.action=e,this.reward=n,this.isTerminal=s}}const J=class J{constructor(t){m(this,"state");m(this,"goals");m(this,"reverseAction",null);m(this,"bigCircleAction1",[]);m(this,"bigCircleAction2",[]);m(this,"smallCircleAction1",[]);m(this,"smallCircleAction2",[]);m(this,"circleAction",[]);J.lessonProducer=t,J.lessonProducer.shuffleBoardState();const e=J.lessonProducer.getState();this.goals=J.lessonProducer.getGoals(),this.state=new q(e,J.lessonProducer)}static isTerminalSuccess(t){return J._isTerminalSuccess(t.getBoardState(),t.getGoals())}reset(){this.reverseAction=null,this.circleAction=[],this.bigCircleAction1=[],this.bigCircleAction2=[],this.smallCircleAction1=[],this.smallCircleAction2=[],this.bigCircleAction1.push(A.L,A.L,A.D,A.D,A.R,A.R,A.U,A.U),this.bigCircleAction2.push(A.R,A.R,A.D,A.D,A.L,A.L,A.U,A.U),this.smallCircleAction1.push(A.L,A.D,A.R,A.U,A.L),this.smallCircleAction2.push(A.R,A.D,A.L,A.U,A.R)}getInitState(){J.lessonProducer.shuffleBoardState();const t=J.lessonProducer.getState();return this.goals=J.lessonProducer.getGoals(),this.state=new q(t,J.lessonProducer),this.state}executeAction(t,e){const n=C.makeMove(t.getBoardState(),e),s=new q(n,J.lessonProducer);let i=J._isTerminalSuccess(n,this.goals);this.state=new q(n,J.lessonProducer);let g=NaN;this.reverseAction=C.getReverseAction(e),this.circleAction.push(e),this.circleAction.length>8&&this.circleAction.shift(),(G.equalArrays(this.circleAction,this.bigCircleAction1)||G.equalArrays(this.circleAction,this.bigCircleAction2)||G.equalArrays(this.circleAction,this.smallCircleAction1)||G.equalArrays(this.circleAction,this.smallCircleAction2))&&(i=!0);const o=this.state.getBoardState().indexOf(-1);return J.lessonProducer.isLockedIndex(o)&&(i=!0,g=-1),isNaN(g)&&(g=this.getReward(n,this.goals)),new Ht(s,e,g,i)}static _isTerminalSuccess(t,e){return e.filter(s=>t[s-1]===s).length===e.length}prntInfo(){G.prnt(`

------------------------------------------------------------------
`);const t=this.state.getBoardState(),e=t.indexOf(-1),n=C.getXY(e);G.prnt(n.getKey()+" - "+n.getValue());const s=C.getIndex(n.getKey(),n.getValue());G.prnt(`${e} - ${s}`);const i=C._getValidMoves(e);G.prnt(i);const g=this.getReward(t,this.goals);G.prnt("reward: "+g),G.prnt(`
`),C.prntState(this.state)}getReward(t,e){const n=t.indexOf(-1),s=C.getXY(n),g=e.map(p=>this.getDistance(C.getXY(t.indexOf(p)),C.getXY(p-1))).reduce((p,x)=>p+x,0);if(g===0)return 100.5;const o=e.reduce((p,x)=>p+this.getDistance(C.getXY(t.indexOf(x)),s),0);return 1/(g+o)}getDistance(t,e){const n=Math.pow(e.getKey()-t.getKey(),2),s=Math.pow(e.getValue()-t.getValue(),2);return Math.sqrt(n+s)}};m(J,"lessonProducer");let pt=J;class At{static shuffle(t,e,n){const s=e.map(i=>i-1);for(let i=0;i<n;i++)t=At.makeRandomMove(t,s);return t}static makeRandomMove(t,e){const n=t.indexOf(-1),s=C.getValidMoves(n,e),i=G.shuffleArray(s)[0];return C.makeMove(t,i)}static shuffleForTraining(t){const e=Array.from({length:16},(g,o)=>o+1).filter(g=>!t.includes(g)),n=[...e].sort(()=>Math.random()-.5),s=e.map((g,o)=>ht.from(g,n[o]));return Array.from({length:16},(g,o)=>this.zip(s,o)).map(g=>g.getValue()===16?-1:g.getValue())}static zip(t,e){const n=t.find(s=>s.getKey()===e+1);return n===void 0?ht.from(e,e+1):ht.from(e,n.getValue())}}class at{static async getFile(t){let e="";try{const n=await fetch(t);if(!n.ok)throw new Error(`HTTP error! Status: ${n.status}`);e=await n.text()}catch(n){console.error("Error reading file: "+t,n)}finally{return e}}}class Vt{static async getQTableActionMap(){const t="dist/qTableActions.csv",e="/public/qTableActions.csv";let n=await at.getFile(t);n=n===""?await at.getFile(e):n;const s=n.trim().split(`
`),i=new Map;return s.forEach(g=>{const[o,p]=g.trim().split(",");i.set(o,A[p])}),i}static getStateActionKey(t){const e=t.getBoardState(),n=t.getGoals();return Array.from({length:16},(i,g)=>{let o;const p=e[g];return p===-1?o="*":n.includes(p)?o=`${p}`:n.includes(g+1)?o="o":o=" ",o+="_",g!==0&&(g+1)%4===0&&(o+="|"),o}).join("").trim()}}const vt=class vt{static async getConfiguration(){if(this.configuration!==void 0)return this.configuration;let t=await this.getConfigurationJson();try{return this.configuration=JSON.parse(t)}catch(e){return console.error("Invalid JSON string:",e),this.configuration={}}}static async getConfigurationJson(){if(this.configurationJson!==void 0)return this.configurationJson;const t="dist/configuration.json",e="/public/configuration.json";return this.configurationJson=await at.getFile(t),this.configurationJson===""?await at.getFile(e):this.configurationJson}static async updateConfigurationJson(t){try{let e=JSON.parse(t);return this.configurationJson=t,this.configuration=e,await vt.updateTester(),await U.restartTrainerIfIsRunning(),{success:!0,messgae:"Configuration updated successfully."}}catch(e){return console.error("Invalid JSON string:",e),{success:!1,messgae:"Invalid JSON string: "+e}}}static async updateTester(){const t=this.configuration.usePretrainedDataWhileTesting;Ft.usePreloadedActions!==t&&await U.restartTesterIfIsRunning()}};m(vt,"configurationJson"),m(vt,"configuration");let ct=vt;class mt{static async getLessonsConfiguration(){if(this.configuration!==void 0)return this.configuration;let t=await this.getLessonsConfigurationJson();try{return this.configuration=JSON.parse(t),this.configuration}catch(e){return console.error("Invalid JSON string:",e),this.configuration={}}}static async getLessonsConfigurationJson(){if(this.configurationJson!==void 0)return this.configurationJson;const t="dist/lessons.json",e="/public/lessons.json";return this.configurationJson=await at.getFile(t),this.configurationJson===""?await at.getFile(e):this.configurationJson}static async updateLessonsConfigurationJson(t){try{let e=JSON.parse(t);return this.configurationJson=t,this.configuration=e,await U.restartTesterIfIsRunning(),await U.restartTrainerIfIsRunning(),{success:!0,messgae:"Lessons configuration updated successfully."}}catch(e){return console.error("Invalid JSON string:",e),{success:!1,messgae:"Invalid JSON string: "+e}}}static getOriginalLessonParams(){return[{goals:[1,2]},{goals:[3,4]},{goals:[5,6]},{goals:[7,8]},{goals:[9,13]},{goals:[10,11,14,15]},{goals:[12]}]}}m(mt,"configurationJson"),m(mt,"configuration");const wt=class wt{constructor(t,e){m(this,"boardState");m(this,"episodesToTrain");m(this,"lesson");m(this,"lockedElements");this.boardState=[],this.lesson=t,this.episodesToTrain=0,this.lockedElements=e}getState(){return this.boardState}getGoals(){return this.lesson.goals}getLockedStateElements(){return this.lockedElements}getEpisodesToTrain(){return this.episodesToTrain}static async getLessonProducersFromJson(){var o,p;let t=await ct.getConfiguration(),e=await mt.getLessonsConfiguration();const n=t.trainerConfiguration;if((n==null?void 0:n.lessonsId)===void 0)throw D.prntErrorMsg("trainerConfiguration?.lessonsId === undefined"),new Error("trainerConfiguration?.lessonsId === undefined");let s,i=null;if(t.usePretrainedDataWhileTesting===!0)i=mt.getOriginalLessonParams();else{let x=(n==null?void 0:n.lessonsId)??"";i=((p=(o=e.allLessons)==null?void 0:o.find(T=>T.id===x))==null?void 0:p.lessons)??null}if(i===null)throw D.prntErrorMsg("no lessons found for lessonsId: '"+s+"'"),new Error("lessons === null");const g=(n==null?void 0:n.lessonsToGenerate)??100;return i.map((x,T)=>{let N=i.filter((I,V)=>V<T).flatMap(I=>I.goals)??[];return wt.from(x,N,g)})}static from(t,e,n){const s=new wt(t,e);return s.lesson=t,s.episodesToTrain=t.lessonsToGenerate!==void 0?t.lessonsToGenerate:n,s.shuffleBoardState(),s}isLockedIndex(t){return this.getLockedStateElements().includes(t+1)}shuffleBoardState(){const t=this.getLockedStateElements();this.boardState=At.shuffleForTraining(t)}};m(wt,"stateDone",[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,-1]);let ut=wt;const ot=class ot{async test(t){this.stop();const e=new Ft;await e.init(t),e.makeMove(),ot.testerIntervalId=setInterval(()=>e.makeMove(),500)}stop(){ot.testerIntervalId!==null&&(clearInterval(ot.testerIntervalId),ot.testerIntervalId=null)}};m(ot,"testerIntervalId",null);let Ct=ot;class jt{constructor(t){m(this,"lessonNo",0);m(this,"lessons");m(this,"lessonCount");m(this,"stateProducer");m(this,"state");m(this,"goals");m(this,"gameOver",!1);m(this,"step",0);m(this,"reverseAction",null);this.lessons=t,this.lessonCount=t.length,this.stateProducer=t[this.lessonNo];let e=At.shuffle(ut.stateDone,[],1e3);this.state=new q(e,this.stateProducer),this.goals=this.stateProducer.getGoals()}resetIfGameIsOver(){if(!this.gameOver)return;this.lessonNo=0,this.stateProducer=this.lessons[this.lessonNo];let t=At.shuffle(ut.stateDone,[],1e3);this.state=new q(t,this.stateProducer),this.goals=this.stateProducer.getGoals(),this.gameOver=!1,this.step=0,this.reverseAction=null}}const _=class _{constructor(){m(this,"ctx",null);m(this,"maxEpisodeSteps",200)}async init(t){const e=await ut.getLessonProducersFromJson();this.ctx=new jt(e),await this.loadedActionMap(t)}async loadedActionMap(t){const e=await ct.getConfiguration();_.usePreloadedActions=t??e.usePretrainedDataWhileTesting??!0,_.usePreloadedActions&&_.actionMap===null&&(_.actionMap=await Vt.getQTableActionMap())}makeMove(){if(this.ctx===null)return;this.ctx.gameOver=this.isGameDone(this.ctx.state),this.ctx.resetIfGameIsOver(),this.ctx.step++;let t=this.getAction(this.ctx.state,this.ctx.reverseAction);this.ctx.reverseAction=C.getReverseAction(t);const e=C.makeMove(this.ctx.state.getBoardState(),t),n=pt._isTerminalSuccess(e,this.ctx.goals);if(this.ctx.state=new q(e,this.ctx.stateProducer),this.ctx.gameOver=this.isGameDone(this.ctx.state),this.ctx.gameOver=this.ctx.step>this.maxEpisodeSteps,this.prntState(this.ctx.state,this.ctx.step),n&&!this.ctx.gameOver&&this.ctx.lessonNo<this.ctx.lessonCount-1&&(this.ctx.lessonNo++,this.ctx.stateProducer=this.ctx.lessons[this.ctx.lessonNo],this.ctx.goals=this.ctx.stateProducer.getGoals(),this.ctx.state=new q(this.ctx.state.getBoardState(),this.ctx.stateProducer)),n&&this.ctx.gameOver&&this.ctx.lessonNo===this.ctx.lessonCount-1){const s=pt.isTerminalSuccess(this.ctx.state)?"success":"failed";this.prntTerminalState(this.ctx.state,this.ctx.step,s)}this.ctx.resetIfGameIsOver()}getAction(t,e){return _.usePreloadedActions?this.getActionFromActionMap(t,e):this.getActionFromQTable(t,e)}getActionFromQTable(t,e){const n=U.qTable,s=t.getHashCodeV2();Rt.addStateWithZeroValuesToQTableIfStateNotExist(n,t);const i=n.get(s);return i?i.getActionWithMaxValue(e):(D.prntErrorMsg("no action found"),C.getFirstPossibleAction(t,e))}getActionFromActionMap(t,e){const n=_.actionMap;let s=Vt.getStateActionKey(t);if(n!=null&&n.has(s)){let i=n.get(s);return i===void 0&&D.prntErrorMsg("no action found"),i===void 0?C.getFirstPossibleAction(t,e):i}else{let i=C.getFirstPossibleAction(t,e);return D.prntErrorMsg("no action was found for state, first posible action is: "+i),i}}isGameDone(t){return G.equalArrays(t.getBoardState(),ut.stateDone)}prntState(t,e){this.prntTerminalState(t,e,null)}prntTerminalState(t,e,n){let s=C.zenGardenOn?"":`${e}
----
`,i=C.getStateAsString(t),g=C.zenGardenOn||n===null?"":`
----
${n}`;D.prntAtSomeElement("shadowTester",s+i+g)}};m(_,"usePreloadedActions",!1),m(_,"actionMap",null);let Ft=_;class qt{constructor(){m(this,"enabled",!0);m(this,"id",0)}enable(){return this.id++,this.enabled=!0,this.id}stop(){this.enabled=!1}isEnabled(){return this.enabled}goodToGo(t){return!(!this.enabled||t!==this.id)}}class Dt{constructor(t,e,n,s,i){m(this,"state");m(this,"action");m(this,"reward");m(this,"done");m(this,"newState");this.state=new q(t),this.action=e,this.reward=n,this.done=s,this.newState=new q(i)}getState(){return this.state}getAction(){return this.action}getReward(){return this.reward}isDone(){return this.done}getNewState(){return this.newState}equals(t){return t instanceof Dt?this.hashCode()===t.hashCode():!1}hashCode(){return this.state.getHashCodeV2()^this.newState.getHashCodeV2()}}const nt=class nt{constructor(){m(this,"maxExperienceSize",2e3)}async train(t,e,n,s,i){if(!xt.semaphore.goodToGo(i))return;const g=U.qTable,o=new pt(t);o.reset();let p=o.getInitState();const x=.5;let T=!1,N=0;for(;!T&&N<50;){if(!xt.semaphore.goodToGo(i))return;if(N++,pt._isTerminalSuccess(p.getBoardState(),p.getGoals()))break;let z,F=C.getPossibleActions(p).filter(c=>c!==o.reverseAction);if(F.length===0)throw C.logBoardState(p.boardState),F=C.getPossibleActions(p),console.log("environment.reverseAction",o.reverseAction),console.log("possibleActions 1",F),F=F.filter(c=>c!==o.reverseAction),console.log("possibleActions 2",F),new Error("possibleActions.length === 0");Math.random()<x?z=C.getRandomAction(F):z=C.getAction(g,p,o.reverseAction);const E=o.executeAction(p,z),L=E.state,l=E.reward;T=E.isTerminal;const r=new Dt(p,z,l,T,L);nt.experience.add(r),p=E.state}nt.replayExperience(nt.experience,g,n,e,this.maxExperienceSize),nt.experience.size>this.maxExperienceSize&&nt.experience.clear();const I=`QTable size: ${g.size}, experience size: ${nt.experience.size}`;let V=`
`+s+`
`+I;D.prntAtSomeElement("episodeTrainer",V),D.prntStatsInfo(I+`
it will start to show some intelligence when the qtable size is around 8500 .. ;)`),await G.sleep(0)}static replayExperience(t,e,n,s,i){Array.from(t).sort(()=>Math.random()-.5).slice(0,i).forEach(o=>{Rt.updateQTable(e,o.getState(),o.getAction(),o.getNewState(),o.getReward(),o.isDone(),n,s)})}};m(nt,"experience",new Set);let kt=nt;const ft=class ft{constructor(){m(this,"episodeTrainer",new kt);m(this,"semaphoreId",null);m(this,"tester",null)}async train(){if(this.semaphoreId=ft.semaphore.enable(),!ft.semaphore.goodToGo(this.semaphoreId))return;await this.runTester(),kt.experience.clear();const e=(await ct.getConfiguration()).trainerConfiguration,n=(e==null?void 0:e.discount)??.9,s=(e==null?void 0:e.learningRate)??.1,i=(e==null?void 0:e.trainingBachCount)??10,g=await ut.getLessonProducersFromJson(),o=async(x,T)=>await this.episodeTrainer.train(x,n,s,T,this.semaphoreId),p=async(x,T,N)=>{let I=x.getEpisodesToTrain();for(let V=0;V<I;V++){let z=T+"Episode: "+(V+1)+" of "+I+`
`+N;await o(x,z)}};for(let x=0;x<i;x++)for(let T=0;T<g.length;T++){let N=g[T],I="Lesson: "+(T+1)+" of "+g.length+`.
`,V="Running training batch: "+(x+1)+" of "+i;await p(N,I,V)}}async runTester(){this.tester=new Ct,await this.tester.test(!1)}stop(){var t;ft.semaphore.stop(),(t=this.tester)==null||t.stop(),this.tester=null}};m(ft,"semaphore",new qt);let xt=ft;class U{static async train(){this.trainer=new xt,await this.trainer.train()}static async test(){this.tester=new Ct,await this.tester.test(void 0)}static async stopTrainer(){var t;(t=this.trainer)==null||t.stop(),this.trainer=null}static async stopTester(){var t;(t=this.tester)==null||t.stop(),this.tester=null}static async restartTesterIfIsRunning(){this.tester!==null&&(await this.stopTester(),await this.test())}static async restartTrainerIfIsRunning(){this.trainer!==null&&(await this.stopTrainer(),await this.train())}}m(U,"qTable",new Map),m(U,"trainer",null),m(U,"tester",null);const Ut=window;function Qt(h,t,e={}){const n={tab:"	",indentOn:/[({\[]$/,moveToNewLine:/^[)}\]]/,spellcheck:!1,catchTab:!0,preserveIdent:!0,addClosing:!0,history:!0,window:Ut,...e},s=n.window,i=s.document,g=[],o=[];let p=-1,x=!1,T=()=>{},N;h.setAttribute("contenteditable","plaintext-only"),h.setAttribute("spellcheck",n.spellcheck?"true":"false"),h.style.outline="none",h.style.overflowWrap="break-word",h.style.overflowY="auto",h.style.whiteSpace="pre-wrap";const I=(a,u)=>{t(a,u)};let V=!1;h.contentEditable!=="plaintext-only"&&(V=!0),V&&h.setAttribute("contenteditable","true");const z=Tt(()=>{const a=r();I(h,a),c(a)},30);let F=!1;const E=a=>!P(a)&&!H(a)&&a.key!=="Meta"&&a.key!=="Control"&&a.key!=="Alt"&&!a.key.startsWith("Arrow"),L=Tt(a=>{E(a)&&(X(),F=!1)},300),l=(a,u)=>{g.push([a,u]),h.addEventListener(a,u)};l("keydown",a=>{a.defaultPrevented||(N=Q(),n.preserveIdent?S(a):b(a),n.catchTab&&$(a),n.addClosing&&M(a),n.history&&(Z(a),E(a)&&!F&&(X(),F=!0)),V&&!st(a)&&c(r()))}),l("keyup",a=>{a.defaultPrevented||a.isComposing||(N!==Q()&&z(),L(a),T(Q()))}),l("focus",a=>{x=!0}),l("blur",a=>{x=!1}),l("paste",a=>{X(),St(a),X(),T(Q())}),l("cut",a=>{X(),It(a),X(),T(Q())});function r(){const a=W(),u={start:0,end:0,dir:void 0};let{anchorNode:y,anchorOffset:w,focusNode:k,focusOffset:O}=a;if(!y||!k)throw"error1";if(y===h&&k===h)return u.start=w>0&&h.textContent?h.textContent.length:0,u.end=O>0&&h.textContent?h.textContent.length:0,u.dir=O>=w?"->":"<-",u;if(y.nodeType===Node.ELEMENT_NODE){const R=i.createTextNode("");y.insertBefore(R,y.childNodes[w]),y=R,w=0}if(k.nodeType===Node.ELEMENT_NODE){const R=i.createTextNode("");k.insertBefore(R,k.childNodes[O]),k=R,O=0}return Et(h,R=>{if(R===y&&R===k)return u.start+=w,u.end+=O,u.dir=w<=O?"->":"<-","stop";if(R===y)if(u.start+=w,!u.dir)u.dir="->";else return"stop";else if(R===k)if(u.end+=O,!u.dir)u.dir="<-";else return"stop";R.nodeType===Node.TEXT_NODE&&(u.dir!="->"&&(u.start+=R.nodeValue.length),u.dir!="<-"&&(u.end+=R.nodeValue.length))}),h.normalize(),u}function c(a){var Lt,Nt;const u=W();let y,w=0,k,O=0;if(a.dir||(a.dir="->"),a.start<0&&(a.start=0),a.end<0&&(a.end=0),a.dir=="<-"){const{start:Y,end:et}=a;a.start=et,a.end=Y}let R=0;Et(h,Y=>{if(Y.nodeType!==Node.TEXT_NODE)return;const et=(Y.nodeValue||"").length;if(R+et>a.start&&(y||(y=Y,w=a.start-R),R+et>a.end))return k=Y,O=a.end-R,"stop";R+=et}),y||(y=h,w=h.childNodes.length),k||(k=h,O=h.childNodes.length),a.dir=="<-"&&([y,w,k,O]=[k,O,y,w]);{const Y=d(y);if(Y){const yt=i.createTextNode("");(Lt=Y.parentNode)==null||Lt.insertBefore(yt,Y),y=yt,w=0}const et=d(k);if(et){const yt=i.createTextNode("");(Nt=et.parentNode)==null||Nt.insertBefore(yt,et),k=yt,O=0}}u.setBaseAndExtent(y,w,k,O),h.normalize()}function d(a){for(;a&&a!==h;){if(a.nodeType===Node.ELEMENT_NODE){const u=a;if(u.getAttribute("contenteditable")=="false")return u}a=a.parentNode}}function f(){const u=W().getRangeAt(0),y=i.createRange();return y.selectNodeContents(h),y.setEnd(u.startContainer,u.startOffset),y.toString()}function v(){const u=W().getRangeAt(0),y=i.createRange();return y.selectNodeContents(h),y.setStart(u.endContainer,u.endOffset),y.toString()}function S(a){if(a.key==="Enter"){const u=f(),y=v();let[w]=K(u),k=w;if(n.indentOn.test(u)&&(k+=n.tab),k.length>0?(j(a),a.stopPropagation(),B(`
`+k)):b(a),k!==w&&n.moveToNewLine.test(y)){const O=r();B(`
`+w),c(O)}}}function b(a){if(V&&a.key==="Enter")if(j(a),a.stopPropagation(),v()==""){B(`
 `);const u=r();u.start=--u.end,c(u)}else B(`
`)}function M(a){const u=`([{'"`,y=`)]}'"`;if(u.includes(a.key)){j(a);const w=r(),k=w.start==w.end?"":W().toString(),O=a.key+k+y[u.indexOf(a.key)];B(O),w.start++,w.end++,c(w)}}function $(a){if(a.key==="Tab")if(j(a),a.shiftKey){const u=f();let[y,w]=K(u);if(y.length>0){const k=r(),O=Math.min(n.tab.length,y.length);c({start:w,end:w+O}),i.execCommand("delete"),k.start-=O,k.end-=O,c(k)}}else B(n.tab)}function Z(a){if(P(a)){j(a),p--;const u=o[p];u&&(h.innerHTML=u.html,c(u.pos)),p<0&&(p=0)}if(H(a)){j(a),p++;const u=o[p];u&&(h.innerHTML=u.html,c(u.pos)),p>=o.length&&p--}}function X(){if(!x)return;const a=h.innerHTML,u=r(),y=o[p];if(y&&y.html===a&&y.pos.start===u.start&&y.pos.end===u.end)return;p++,o[p]={html:a,pos:u},o.splice(p+1);const w=300;p>w&&(p=w,o.splice(0,1))}function St(a){if(a.defaultPrevented)return;j(a);const y=(a.originalEvent??a).clipboardData.getData("text/plain").replace(/\r\n?/g,`
`),w=r();B(y),I(h),c({start:Math.min(w.start,w.end)+y.length,end:Math.min(w.start,w.end)+y.length,dir:"<-"})}function It(a){const u=r(),y=W();(a.originalEvent??a).clipboardData.setData("text/plain",y.toString()),i.execCommand("delete"),I(h),c({start:Math.min(u.start,u.end),end:Math.min(u.start,u.end),dir:"<-"}),j(a)}function Et(a,u){const y=[];a.firstChild&&y.push(a.firstChild);let w=y.pop();for(;w&&u(w)!=="stop";)w.nextSibling&&y.push(w.nextSibling),w.firstChild&&y.push(w.firstChild),w=y.pop()}function dt(a){return a.metaKey||a.ctrlKey}function P(a){return dt(a)&&!a.shiftKey&&it(a)==="Z"}function H(a){return dt(a)&&a.shiftKey&&it(a)==="Z"}function st(a){return dt(a)&&it(a)==="C"}function it(a){let u=a.key||a.keyCode||a.which;if(u)return(typeof u=="string"?u:String.fromCharCode(u)).toUpperCase()}function B(a){a=a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),i.execCommand("insertHTML",!1,a)}function Tt(a,u){let y=0;return(...w)=>{clearTimeout(y),y=s.setTimeout(()=>a(...w),u)}}function K(a){let u=a.length-1;for(;u>=0&&a[u]!==`
`;)u--;u++;let y=u;for(;y<a.length&&/[ \t]/.test(a[y]);)y++;return[a.substring(u,y)||"",u,y]}function Q(){return h.textContent||""}function j(a){a.preventDefault()}function W(){var a;return((a=h.parentNode)==null?void 0:a.nodeType)==Node.DOCUMENT_FRAGMENT_NODE?h.parentNode.getSelection():s.getSelection()}return{updateOptions(a){Object.assign(n,a)},updateCode(a){h.textContent=a,I(h),T(a)},onUpdate(a){T=a},toString:Q,save:r,restore:c,recordHistory:X,destroy(){for(let[a,u]of g)h.removeEventListener(a,u)}}}var Pt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},$t={exports:{}};(function(h){var t=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var e=function(n){var s=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,i=0,g={},o={manual:n.Prism&&n.Prism.manual,disableWorkerMessageHandler:n.Prism&&n.Prism.disableWorkerMessageHandler,util:{encode:function l(r){return r instanceof p?new p(r.type,l(r.content),r.alias):Array.isArray(r)?r.map(l):r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(l){return Object.prototype.toString.call(l).slice(8,-1)},objId:function(l){return l.__id||Object.defineProperty(l,"__id",{value:++i}),l.__id},clone:function l(r,c){c=c||{};var d,f;switch(o.util.type(r)){case"Object":if(f=o.util.objId(r),c[f])return c[f];d={},c[f]=d;for(var v in r)r.hasOwnProperty(v)&&(d[v]=l(r[v],c));return d;case"Array":return f=o.util.objId(r),c[f]?c[f]:(d=[],c[f]=d,r.forEach(function(S,b){d[b]=l(S,c)}),d);default:return r}},getLanguage:function(l){for(;l;){var r=s.exec(l.className);if(r)return r[1].toLowerCase();l=l.parentElement}return"none"},setLanguage:function(l,r){l.className=l.className.replace(RegExp(s,"gi"),""),l.classList.add("language-"+r)},currentScript:function(){if(typeof document>"u")return null;if("currentScript"in document)return document.currentScript;try{throw new Error}catch(d){var l=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(d.stack)||[])[1];if(l){var r=document.getElementsByTagName("script");for(var c in r)if(r[c].src==l)return r[c]}return null}},isActive:function(l,r,c){for(var d="no-"+r;l;){var f=l.classList;if(f.contains(r))return!0;if(f.contains(d))return!1;l=l.parentElement}return!!c}},languages:{plain:g,plaintext:g,text:g,txt:g,extend:function(l,r){var c=o.util.clone(o.languages[l]);for(var d in r)c[d]=r[d];return c},insertBefore:function(l,r,c,d){d=d||o.languages;var f=d[l],v={};for(var S in f)if(f.hasOwnProperty(S)){if(S==r)for(var b in c)c.hasOwnProperty(b)&&(v[b]=c[b]);c.hasOwnProperty(S)||(v[S]=f[S])}var M=d[l];return d[l]=v,o.languages.DFS(o.languages,function($,Z){Z===M&&$!=l&&(this[$]=v)}),v},DFS:function l(r,c,d,f){f=f||{};var v=o.util.objId;for(var S in r)if(r.hasOwnProperty(S)){c.call(r,S,r[S],d||S);var b=r[S],M=o.util.type(b);M==="Object"&&!f[v(b)]?(f[v(b)]=!0,l(b,c,null,f)):M==="Array"&&!f[v(b)]&&(f[v(b)]=!0,l(b,c,S,f))}}},plugins:{},highlightAll:function(l,r){o.highlightAllUnder(document,l,r)},highlightAllUnder:function(l,r,c){var d={callback:c,container:l,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};o.hooks.run("before-highlightall",d),d.elements=Array.prototype.slice.apply(d.container.querySelectorAll(d.selector)),o.hooks.run("before-all-elements-highlight",d);for(var f=0,v;v=d.elements[f++];)o.highlightElement(v,r===!0,d.callback)},highlightElement:function(l,r,c){var d=o.util.getLanguage(l),f=o.languages[d];o.util.setLanguage(l,d);var v=l.parentElement;v&&v.nodeName.toLowerCase()==="pre"&&o.util.setLanguage(v,d);var S=l.textContent,b={element:l,language:d,grammar:f,code:S};function M(Z){b.highlightedCode=Z,o.hooks.run("before-insert",b),b.element.innerHTML=b.highlightedCode,o.hooks.run("after-highlight",b),o.hooks.run("complete",b),c&&c.call(b.element)}if(o.hooks.run("before-sanity-check",b),v=b.element.parentElement,v&&v.nodeName.toLowerCase()==="pre"&&!v.hasAttribute("tabindex")&&v.setAttribute("tabindex","0"),!b.code){o.hooks.run("complete",b),c&&c.call(b.element);return}if(o.hooks.run("before-highlight",b),!b.grammar){M(o.util.encode(b.code));return}if(r&&n.Worker){var $=new Worker(o.filename);$.onmessage=function(Z){M(Z.data)},$.postMessage(JSON.stringify({language:b.language,code:b.code,immediateClose:!0}))}else M(o.highlight(b.code,b.grammar,b.language))},highlight:function(l,r,c){var d={code:l,grammar:r,language:c};if(o.hooks.run("before-tokenize",d),!d.grammar)throw new Error('The language "'+d.language+'" has no grammar.');return d.tokens=o.tokenize(d.code,d.grammar),o.hooks.run("after-tokenize",d),p.stringify(o.util.encode(d.tokens),d.language)},tokenize:function(l,r){var c=r.rest;if(c){for(var d in c)r[d]=c[d];delete r.rest}var f=new N;return I(f,f.head,l),T(l,f,r,f.head,0),z(f)},hooks:{all:{},add:function(l,r){var c=o.hooks.all;c[l]=c[l]||[],c[l].push(r)},run:function(l,r){var c=o.hooks.all[l];if(!(!c||!c.length))for(var d=0,f;f=c[d++];)f(r)}},Token:p};n.Prism=o;function p(l,r,c,d){this.type=l,this.content=r,this.alias=c,this.length=(d||"").length|0}p.stringify=function l(r,c){if(typeof r=="string")return r;if(Array.isArray(r)){var d="";return r.forEach(function(M){d+=l(M,c)}),d}var f={type:r.type,content:l(r.content,c),tag:"span",classes:["token",r.type],attributes:{},language:c},v=r.alias;v&&(Array.isArray(v)?Array.prototype.push.apply(f.classes,v):f.classes.push(v)),o.hooks.run("wrap",f);var S="";for(var b in f.attributes)S+=" "+b+'="'+(f.attributes[b]||"").replace(/"/g,"&quot;")+'"';return"<"+f.tag+' class="'+f.classes.join(" ")+'"'+S+">"+f.content+"</"+f.tag+">"};function x(l,r,c,d){l.lastIndex=r;var f=l.exec(c);if(f&&d&&f[1]){var v=f[1].length;f.index+=v,f[0]=f[0].slice(v)}return f}function T(l,r,c,d,f,v){for(var S in c)if(!(!c.hasOwnProperty(S)||!c[S])){var b=c[S];b=Array.isArray(b)?b:[b];for(var M=0;M<b.length;++M){if(v&&v.cause==S+","+M)return;var $=b[M],Z=$.inside,X=!!$.lookbehind,St=!!$.greedy,It=$.alias;if(St&&!$.pattern.global){var Et=$.pattern.toString().match(/[imsuy]*$/)[0];$.pattern=RegExp($.pattern.source,Et+"g")}for(var dt=$.pattern||$,P=d.next,H=f;P!==r.tail&&!(v&&H>=v.reach);H+=P.value.length,P=P.next){var st=P.value;if(r.length>l.length)return;if(!(st instanceof p)){var it=1,B;if(St){if(B=x(dt,H,l,X),!B||B.index>=l.length)break;var j=B.index,Tt=B.index+B[0].length,K=H;for(K+=P.value.length;j>=K;)P=P.next,K+=P.value.length;if(K-=P.value.length,H=K,P.value instanceof p)continue;for(var Q=P;Q!==r.tail&&(K<Tt||typeof Q.value=="string");Q=Q.next)it++,K+=Q.value.length;it--,st=l.slice(H,K),B.index-=H}else if(B=x(dt,0,st,X),!B)continue;var j=B.index,W=B[0],a=st.slice(0,j),u=st.slice(j+W.length),y=H+st.length;v&&y>v.reach&&(v.reach=y);var w=P.prev;a&&(w=I(r,w,a),H+=a.length),V(r,w,it);var k=new p(S,Z?o.tokenize(W,Z):W,It,W);if(P=I(r,w,k),u&&I(r,P,u),it>1){var O={cause:S+","+M,reach:y};T(l,r,c,P.prev,H,O),v&&O.reach>v.reach&&(v.reach=O.reach)}}}}}}function N(){var l={value:null,prev:null,next:null},r={value:null,prev:l,next:null};l.next=r,this.head=l,this.tail=r,this.length=0}function I(l,r,c){var d=r.next,f={value:c,prev:r,next:d};return r.next=f,d.prev=f,l.length++,f}function V(l,r,c){for(var d=r.next,f=0;f<c&&d!==l.tail;f++)d=d.next;r.next=d,d.prev=r,l.length-=f}function z(l){for(var r=[],c=l.head.next;c!==l.tail;)r.push(c.value),c=c.next;return r}if(!n.document)return n.addEventListener&&(o.disableWorkerMessageHandler||n.addEventListener("message",function(l){var r=JSON.parse(l.data),c=r.language,d=r.code,f=r.immediateClose;n.postMessage(o.highlight(d,o.languages[c],c)),f&&n.close()},!1)),o;var F=o.util.currentScript();F&&(o.filename=F.src,F.hasAttribute("data-manual")&&(o.manual=!0));function E(){o.manual||o.highlightAll()}if(!o.manual){var L=document.readyState;L==="loading"||L==="interactive"&&F&&F.defer?document.addEventListener("DOMContentLoaded",E):window.requestAnimationFrame?window.requestAnimationFrame(E):window.setTimeout(E,16)}return o}(t);h.exports&&(h.exports=e),typeof Pt<"u"&&(Pt.Prism=e),e.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},e.languages.markup.tag.inside["attr-value"].inside.entity=e.languages.markup.entity,e.languages.markup.doctype.inside["internal-subset"].inside=e.languages.markup,e.hooks.add("wrap",function(n){n.type==="entity"&&(n.attributes.title=n.content.replace(/&amp;/,"&"))}),Object.defineProperty(e.languages.markup.tag,"addInlined",{value:function(s,i){var g={};g["language-"+i]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:e.languages[i]},g.cdata=/^<!\[CDATA\[|\]\]>$/i;var o={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:g}};o["language-"+i]={pattern:/[\s\S]+/,inside:e.languages[i]};var p={};p[s]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return s}),"i"),lookbehind:!0,greedy:!0,inside:o},e.languages.insertBefore("markup","cdata",p)}}),Object.defineProperty(e.languages.markup.tag,"addAttribute",{value:function(n,s){e.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+n+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[s,"language-"+s],inside:e.languages[s]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),e.languages.html=e.languages.markup,e.languages.mathml=e.languages.markup,e.languages.svg=e.languages.markup,e.languages.xml=e.languages.extend("markup",{}),e.languages.ssml=e.languages.xml,e.languages.atom=e.languages.xml,e.languages.rss=e.languages.xml,function(n){var s=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;n.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+s.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+s.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+s.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+s.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:s,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},n.languages.css.atrule.inside.rest=n.languages.css;var i=n.languages.markup;i&&(i.tag.addInlined("style","css"),i.tag.addAttribute("style","css"))}(e),e.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},e.languages.javascript=e.languages.extend("clike",{"class-name":[e.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),e.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,e.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:e.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:e.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:e.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:e.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:e.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),e.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:e.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),e.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),e.languages.markup&&(e.languages.markup.tag.addInlined("script","javascript"),e.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),e.languages.js=e.languages.javascript,function(){if(typeof e>"u"||typeof document>"u")return;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var n="Loading…",s=function(F,E){return"✖ Error "+F+" while fetching file: "+E},i="✖ Error: File does not exist or is empty",g={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},o="data-src-status",p="loading",x="loaded",T="failed",N="pre[data-src]:not(["+o+'="'+x+'"]):not(['+o+'="'+p+'"])';function I(F,E,L){var l=new XMLHttpRequest;l.open("GET",F,!0),l.onreadystatechange=function(){l.readyState==4&&(l.status<400&&l.responseText?E(l.responseText):l.status>=400?L(s(l.status,l.statusText)):L(i))},l.send(null)}function V(F){var E=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(F||"");if(E){var L=Number(E[1]),l=E[2],r=E[3];return l?r?[L,Number(r)]:[L,void 0]:[L,L]}}e.hooks.add("before-highlightall",function(F){F.selector+=", "+N}),e.hooks.add("before-sanity-check",function(F){var E=F.element;if(E.matches(N)){F.code="",E.setAttribute(o,p);var L=E.appendChild(document.createElement("CODE"));L.textContent=n;var l=E.getAttribute("data-src"),r=F.language;if(r==="none"){var c=(/\.(\w+)$/.exec(l)||[,"none"])[1];r=g[c]||c}e.util.setLanguage(L,r),e.util.setLanguage(E,r);var d=e.plugins.autoloader;d&&d.loadLanguages(r),I(l,function(f){E.setAttribute(o,x);var v=V(E.getAttribute("data-range"));if(v){var S=f.split(/\r\n?|\n/g),b=v[0],M=v[1]==null?S.length:v[1];b<0&&(b+=S.length),b=Math.max(0,Math.min(b-1,S.length)),M<0&&(M+=S.length),M=Math.max(0,Math.min(M,S.length)),f=S.slice(b,M).join(`
`),E.hasAttribute("data-start")||E.setAttribute("data-start",String(b+1))}L.textContent=f,e.highlightElement(L)},function(f){E.setAttribute(o,T),L.textContent=f})}}),e.plugins.fileHighlight={highlight:function(E){for(var L=(E||document).querySelectorAll(N),l=0,r;r=L[l++];)e.highlightElement(r)}};var z=!1;e.fileHighlight=function(){z||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),z=!0),e.plugins.fileHighlight.highlight.apply(this,arguments)}}()})($t);var Bt=$t.exports;class gt{static close(){var t;(t=document.getElementById("jsonEditor"))==null||t.remove()}static show(t,e,n=!0){var I;const s=document.getElementById("tools");if(!s)return;(I=document.getElementById("jsonEditor"))==null||I.remove();const i=document.createElement("div"),g=document.createElement("div"),o=document.createElement("div"),p=document.createElement("div"),x=document.createElement("div");s.appendChild(i),i.appendChild(g),i.appendChild(x),i.appendChild(p),i.appendChild(o),i.id="jsonEditor",x.setAttribute("class","console-text"),g.textContent=this.divLine,o.textContent=this.divLine,Qt(p,async V=>this.update(t,V,x,e,n)).updateCode(t)}static async update(t,e,n,s,i){if(e.textContent===null)return;let g=i?e.textContent:t;if(e.innerHTML=Bt.highlight(g,Bt.languages.js,"js"),g===t)return;let o=await s(g);n.textContent=o.messgae}}m(gt,"divLine","--------------------------------------------------------------------------------------------------");const lt=class lt{static async toggleDisplay(t){if(t){const e=await lt.getAboutJson();gt.show(e,async n=>lt.updateStatus,!1)}else gt.close()}static async getAbout(){if(this.about!==void 0)return this.about;let t=await this.getAboutJson();try{return JSON.parse(t)}catch(e){const n="Invalid JSON string: "+e;return console.error(n),this.about=[]}}static async getAboutJson(){if(this.aboutJson!==void 0)return this.aboutJson;const t="dist/about.json",e="/public/about.json";return this.aboutJson=await at.getFile(t),this.aboutJson===""?await at.getFile(e):this.aboutJson}};m(lt,"aboutJson"),m(lt,"about"),m(lt,"updateStatus",{success:!1,messgae:"Not editable."});let rt=lt;class Kt{static async toggleDisplay(t){if(t){const e=await mt.getLessonsConfigurationJson();let n=async s=>mt.updateLessonsConfigurationJson(s);await gt.show(e,n)}else gt.close()}}class Mt{static async toggleDisplay(t){if(t){const e=await ct.getConfigurationJson();let n=async s=>ct.updateConfigurationJson(s);await gt.show(e,n)}else gt.close()}}class tt{static setupTools(){var t,e,n,s,i,g;(t=document.getElementById("startTrainingBtn"))==null||t.addEventListener("click",()=>tt.startTraining().then()),(e=document.getElementById("startTestingBtn"))==null||e.addEventListener("click",()=>tt.startTesting().then()),(n=document.getElementById("zenGardenBtn"))==null||n.addEventListener("click",()=>tt.zenGardenOnOff().then()),(s=document.getElementById("configurationBtn"))==null||s.addEventListener("click",()=>tt.configurationOnOff().then()),(i=document.getElementById("lessonsBtn"))==null||i.addEventListener("click",()=>tt.lessonsOnOff().then()),(g=document.getElementById("aboutBtn"))==null||g.addEventListener("click",()=>tt.aboutOnOff().then())}static async startTraining(){D.prntErrorMsg(""),U.stopTester(),D.clearScreen(),await U.train(),await tt.startTesting()}static async startTesting(){D.prntErrorMsg(""),U.stopTrainer(),D.clearScreen(),await U.test()}static async aboutOnOff(){this.btnOff("configurationBtn","configuration",t=>Mt.toggleDisplay(t)),this.btnOff("lessonsBtn","lessons",t=>rt.toggleDisplay(t)),this.btnOnOff("aboutBtn","about",t=>rt.toggleDisplay(t))}static async lessonsOnOff(){this.btnOff("aboutBtn","about",t=>rt.toggleDisplay(t)),this.btnOff("configurationBtn","configuration",t=>Mt.toggleDisplay(t)),this.btnOnOff("lessonsBtn","lessons",t=>Kt.toggleDisplay(t))}static async configurationOnOff(){this.btnOff("aboutBtn","about",t=>rt.toggleDisplay(t)),this.btnOff("lessonsBtn","lessons",t=>rt.toggleDisplay(t)),this.btnOnOff("configurationBtn","configuration",t=>Mt.toggleDisplay(t))}static async zenGardenOnOff(){this.btnOnOff("zenGardenBtn","zen garden",t=>C.zenGardenOn=t)}static async btnOff(t,e,n){let s=document.getElementById(t);s==null||s.setAttribute("value",e+" off"),n(!1)}static async btnOnOff(t,e,n){D.prntErrorMsg("");let s=document.getElementById(t);(s==null?void 0:s.getAttribute("value"))!==e+" off"?(s==null||s.setAttribute("value",e+" off"),n(!1)):(s==null||s.setAttribute("value",e+" on"),n(!0))}}tt.setupTools();tt.startTesting().then();
