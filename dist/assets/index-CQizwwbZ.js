var De=Object.defineProperty;var Ie=(m,t,e)=>t in m?De(m,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):m[t]=e;var A=(m,t,e)=>Ie(m,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const p of r.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&n(p)}).observe(document,{childList:!0,subtree:!0});function e(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=e(s);fetch(s.href,r)}})();class Z{static blue(t){return'<span style="color: blue;">'+t+"</span>"}static green(t){return'<span style="color: green;">'+t+"</span>"}static red(t){return'<span style="color: red;">'+t+"</span>"}static clearScreen(){const t=document.getElementById("console");t&&(t.innerHTML="")}static prntTestStep(t){this.addElementToConsoleDiv("testGameStep",t)}static prntStatsInfo(t){const e=document.getElementById("statsInfo");e&&(e.textContent=t.toLowerCase().replace(", "," | "))}static addElementToConsoleDiv(t,e){const n=document.getElementById(t);n?n.innerHTML=e:this.prnt(e,"color:black;",t)}static prnt(t,e="color:black;",n=null){const s=document.getElementById("console");if(s){const r=document.createElement("div");r.innerHTML=t,e&&(r.style.cssText=e),n!==null&&(r.id=n),s.appendChild(r),s.scrollTop=s.scrollHeight}}static warn(t){this.prnt(t,"color: orange;")}static testPrint(){this.prnt("Hello, World!"),this.prnt("Error: Something went wrong!","color: red;"),this.prnt("Info: This is some information.","color: #00ff00;"),this.prnt("Warning: Be careful!","color: orange;")}}const be=class be{static prnt(t,e="color: black;"){Z.prnt(t,e)}static str(t,e){const n=t.toString();if(n.length>=e)return n;const s=e-n.length;return n+be.emptyString.substring(0,s)}static sum(t){return!t||(t=t.filter(e=>e!==0),t.length===0)?0:t.reduce((e,n)=>e+n,0)}static toString(t){return`[${Array.from(t).map(String).join(", ")}]`}static px(){return(t,e)=>t}static equalArrays(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}static shuffleArray(t){return t.sort(()=>Math.random()-.5)}static _sleep(t){return new Promise(e=>setTimeout(e,t))}static async sleep(t){await this._sleep(t)}};A(be,"emptyString","                                           ");let F=be;class xe{constructor(t,e){this.key=t,this.value=e}getKey(){return this.key}getValue(){return this.value}static P(t,e){return new xe(t,e)}}var w=(m=>(m.L="L",m.R="R",m.U="U",m.D="D",m))(w||{});class J{constructor(t,e){A(this,"state");A(this,"goals");A(this,"fixedElements");t instanceof J?(this.state=[...t.getState()],this.goals=[...t.getGoals()],this.fixedElements=[...t.getFixedElements()]):(this.state=[...t],this.goals=[...(e==null?void 0:e.getGoals())??[]],this.fixedElements=[...(e==null?void 0:e.getLockedStateElements())??[]])}getState(){return this.state}setState(t){this.state=t}getGoals(){return this.goals}setGoals(t){this.goals=t}getFixedElements(){return this.fixedElements}setFixedElements(t){this.fixedElements=t}getHashCodeV2(){const t=this.getHashCodeV3__();return this.hashString(t)}getHashCodeV3__(){return Array.from({length:16},(t,e)=>{let n;const s=this.state[e];return s===-1?n="*":this.goals.includes(s)?n=String(s):this.goals.includes(e+1)?n="o":n=" ",n=n+"	",e!==0&&(e+1)%4===0&&(n=n+`
`),n}).join("")}getHashCode(){const t=this.state.map(String).join(",");return this.hashString(t)}hashString(t){let e=0;for(let n=0;n<t.length;n++){const s=t.charCodeAt(n);e=(e<<5)-e+s,e|=0}return e}equals(t){return this.getHashCode()===t.getHashCode()}hashCode(){return this.getHashCode()}}class Ve{constructor(t,e,n=0,s=!1){A(this,"state");A(this,"action");A(this,"reward");A(this,"isTerminal");this.state=t,this.action=e,this.reward=n,this.isTerminal=s}}const j=class j{constructor(t){A(this,"state");A(this,"goals");A(this,"reverseAction",null);A(this,"bigCircleAction1",[]);A(this,"bigCircleAction2",[]);A(this,"smallCircleAction1",[]);A(this,"smallCircleAction2",[]);A(this,"circleAction",[]);j.stateProducer=t,j.stateProducer.resetState();const e=j.stateProducer.getState();this.goals=j.stateProducer.getGoals(),this.state=new J(e,j.stateProducer)}static isTerminalSuccess(t){return j._isTerminalSuccess(t.getState(),t.getGoals())}reset(){this.reverseAction=null,this.circleAction=[],this.bigCircleAction1=[],this.bigCircleAction2=[],this.smallCircleAction1=[],this.smallCircleAction2=[],this.bigCircleAction1.push(w.L,w.L,w.D,w.D,w.R,w.R,w.U,w.U),this.bigCircleAction2.push(w.R,w.R,w.D,w.D,w.L,w.L,w.U,w.U),this.smallCircleAction1.push(w.L,w.D,w.R,w.U,w.L),this.smallCircleAction2.push(w.R,w.D,w.L,w.U,w.R)}getInitState(){j.stateProducer.resetState();const t=j.stateProducer.getState();return this.goals=j.stateProducer.getGoals(),this.state=new J(t,j.stateProducer),this.state}static getPossibleActions(t){const e=t.getState().indexOf(-1),n=t.getFixedElements().map(s=>s-1);return P.getValidMoves(e,n)}executeAction(t,e){const n=P.makeMove(t.getState(),e),s=new J(n,j.stateProducer);let r=j._isTerminalSuccess(n,this.goals);this.state=new J(n,j.stateProducer);let p=NaN;this.reverseAction=P.getReverseAction(e),this.circleAction.push(e),this.circleAction.length>8&&this.circleAction.shift(),(F.equalArrays(this.circleAction,this.bigCircleAction1)||F.equalArrays(this.circleAction,this.bigCircleAction2)||F.equalArrays(this.circleAction,this.smallCircleAction1)||F.equalArrays(this.circleAction,this.smallCircleAction2))&&(r=!0);const o=this.state.getState().indexOf(-1);return j.stateProducer.isLockedIndex(o)&&(r=!0,p=-1),isNaN(p)&&(p=this.getReward(n,this.goals)),new Ve(s,e,p,r)}static _isTerminalSuccess(t,e){if(t.length!==16)throw new Error("newState.size() != 16");return e.filter(n=>t[n-1]===n).length===e.length}prntInfo(){F.prnt(`

------------------------------------------------------------------
`);const t=this.state.getState(),e=t.indexOf(-1),n=P.getXY(e);F.prnt(n.getKey()+" - "+n.getValue());const s=P.getIndex(n.getKey(),n.getValue());F.prnt(`${e} - ${s}`);const r=P._getValidMoves(e);F.prnt(r);const p=this.getReward(t,this.goals);F.prnt("reward: "+p),F.prnt(`
`),P.prntState(t,this.goals)}getReward(t,e){const n=t.indexOf(-1),s=P.getXY(n),p=e.map(h=>this.getDistance(P.getXY(t.indexOf(h)),P.getXY(h-1))).reduce((h,x)=>h+x,0);if(p===0)return 100.5;const o=e.reduce((h,x)=>h+this.getDistance(P.getXY(t.indexOf(x)),s),0);return F.prnt(`d0Sum: ${p}`),F.prnt(`d1Sum: ${o}`),1/(p+o)}getDistance(t,e){const n=Math.pow(e.getKey()-t.getKey(),2),s=Math.pow(e.getValue()-t.getValue(),2);return Math.sqrt(n+s)}};A(j,"stateProducer");let ee=j;class P{static makeMove(t,e){const s=t.indexOf(-1),r=this.getXY(s);let p=r.getKey(),o=r.getValue();e===w.L&&(p-=1),e===w.R&&(p+=1),e===w.U&&(o-=1),e===w.D&&(o+=1);const h=this.getIndex(p,o),x=[...t],L=x[h];return x[s]=L,x[h]=-1,x}static getXY(t){const e=t%4,n=Math.floor(t/4);return xe.P(e,n)}static getIndex(t,e){return e*4+t}static _getValidMoves(t){const e=this.getXY(t),n=Object.values(w).slice();return e.getKey()===0&&n.splice(n.indexOf(w.L),1),e.getKey()===3&&n.splice(n.indexOf(w.R),1),e.getValue()===0&&n.splice(n.indexOf(w.U),1),e.getValue()===3&&n.splice(n.indexOf(w.D),1),n}static getValidMoves(t,e){const n=this._getValidMoves(t),s=this.getXY(t);return this.contains(e,s.getKey()-1,s.getValue())&&n.splice(n.indexOf(w.L),1),this.contains(e,s.getKey()+1,s.getValue())&&n.splice(n.indexOf(w.R),1),this.contains(e,s.getKey(),s.getValue()-1)&&n.splice(n.indexOf(w.U),1),this.contains(e,s.getKey(),s.getValue()+1)&&n.splice(n.indexOf(w.D),1),n}static contains(t,e,n){return t.includes(this.getIndex(e,n))}static stateAsString(t,e){return this.zenGardenOn?this.getStateAsZenStoneGarden(t,e):this.getStateAsString(t,e)}static getStateAsString(t,e){return Array.from({length:16},(n,s)=>{let r;const p=t[s];return p===-1?r=Z.blue("*"):e.includes(p)?r=Z.red(p.toString()):e.includes(s+1)?r=Z.green(p.toString()):r=p.toString(),r+="	",s!==0&&(s+1)%4===0&&(r+=`
`),r}).join("")}static getStateAsZenStoneGarden(t,e){return Array.from({length:16},(n,s)=>{let r;const p=t[s];return e.includes(p)?r="x":e.includes(s+1)?r="o":r="",r+="	",s!==0&&(s+1)%4===0&&(r+=`
`),r}).join("")}static prntState(t,e){let n=this.stateAsString(t,e);Z.prnt(n)}static getReverseAction(t){return t===w.D?w.U:t===w.U?w.D:t===w.L?w.R:t===w.R?w.L:null}static getAction(t,e,n){var p;const s=e.getHashCodeV2();let r=ee.getPossibleActions(e);return r=r.filter(o=>o!==n),t.has(s)?((p=t.get(s))==null?void 0:p.getActionWithMaxValue(n))||w.D:this.getRandomAction(r)}static getRandomAction(t){return t.length>0?t[Math.floor(Math.random()*t.length)]:w.D}static getFirstPossibleActionOrD(t,e){const n=ee.getPossibleActions(t).filter(s=>s!==e);return n.length>0?n[0]:w.D}}A(P,"zenGardenOn",!1);class ie{static main(){const t=le.generateLessons()[0];let e=[...t.getState()];const n=[...t.getGoals()];ie.prntState(e,n),e=ie.shuffle(e,t.getLockedStateElements(),1e3),ie.prntState(e,n)}static shuffle(t,e,n){const s=e.map(p=>p-1);let r=0;for(;r<n;)t=ie.makeRandomMove(t,s),r++;return t}static prntState(t,e){P.prntState(t,e)}static makeRandomMove(t,e){const n=t.indexOf(-1),s=P.getValidMoves(n,e),r=F.shuffleArray(s)[0];return t=P.makeMove(t,r),t}}class ye{static async getFile(t){let e="";try{const n=await fetch(t);if(!n.ok)throw new Error(`HTTP error! Status: ${n.status}`);e=await n.text()}catch(n){console.error("Error reading file: "+t,n)}finally{return e}}}class Se{static async getLessons(){if(this.lessons!==void 0)return this.lessons;let t=await this.getLessonsJson();console.log("lessons loaded");try{return this.lessons=JSON.parse(t),this.lessons.sort((e,n)=>e.lesson-n.lesson),this.lessons}catch(e){return console.error("Invalid JSON string:",e),this.lessons=[]}}static async getLessonsJson(){const t="dist/lessons_0.json",e="/public/lessons_0.json";return this.lessonsJson=await ye.getFile(t),this.lessonsJson===""?await ye.getFile(e):this.lessonsJson}}A(Se,"lessonsJson"),A(Se,"lessons");const d=class d{constructor(t){A(this,"goals");A(this,"lockedStateElements");A(this,"state");A(this,"episodesToTrain");A(this,"lessonNb");this.lessonNb=t,this.goals=[],this.lockedStateElements=[],this.state=[],this.episodesToTrain=0}getState(){return this.state}getGoals(){return this.goals}getLockedStateElements(){return this.lockedStateElements}getEpisodesToTrain(){return this.episodesToTrain}static async getStateProducersFromJson(){return(await Se.getLessons()).map((e,n)=>d.from(e,n))}static from(t,e){const n=new d(e);return n.goals=t.goals,n.lockedStateElements=t.lockedElements!==void 0?t.lockedElements:[],n.episodesToTrain=t.lessonsToGenerate!==void 0?t.lessonsToGenerate:100,n.state=[...d.stateDone],d.shuffle(n,n.lockedStateElements),t.freeCellStartingPositions!==void 0?d.shuffleFreeCellStarPosition(n,t.freeCellStartingPositions.map(s=>s-1)):n}static generateLessons0(){return[d.state1(0),d.shuffleFreeCellStarPosition(d.createStateProducer(2,1),[1,4]),d.shuffleFreeCellStarPosition(d.createStateProducer(3,2),[2,5]),d.shuffleFreeCellStarPosition(d.createStateProducerForGoals_3_4(3),[3,6]),d.shuffleFreeCellStarPosition(d.createStateProducer(5,4),[6,7]),d.shuffleFreeCellStarPosition(d.createStateProducer(6,5),[5,8]),d.shuffleFreeCellStarPosition(d.createStateProducer(7,6),[6,9]),d.shuffleFreeCellStarPosition(d.createStateProducerForGoals_7_8(7),[8,11]),d.shuffleFreeCellStarPosition(d.createStateProducerForGoals_9_13(8),[10,11]),d.shuffleFreeCellStarPosition(d.createStateProducerForGoals_10__15(9),[9,13]),d.state12(10)]}static generateLessonsV1(){return[d.createStateProducerForGoals_1_2(0),d.shuffleFreeCellStarPosition(d.createStateProducerForGoals_3_4(1),[2,3,4]),d.shuffleFreeCellStarPosition(d.createStateProducer(5,2),[6,7]),d.shuffleFreeCellStarPosition(d.createStateProducer(6,3),[5,8]),d.shuffleFreeCellStarPosition(d.createStateProducer(7,4),[6,9]),d.shuffleFreeCellStarPosition(d.createStateProducerForGoals_7_8(5),[8,11]),d.shuffleFreeCellStarPosition(d.createStateProducerForGoals_9_13(6),[10,11]),d.shuffleFreeCellStarPosition(d.createStateProducerForGoals_10__15(7),[9,13]),d.state12(8)]}static generateLessons(){return[d.createStateProducerForGoals_1_2(0),d.shuffleFreeCellStarPosition(d.createStateProducerForGoals_3_4(1),[2,3,4]),d.shuffleFreeCellStarPosition(d.createStateProducerForGoals_5_6(2),[6,7]),d.shuffleFreeCellStarPosition(d.createStateProducerForGoals_7_8(3),[8,9,6]),d.shuffleFreeCellStarPosition(d.createStateProducerForGoals_9_13(4),[10,11]),d.shuffleFreeCellStarPosition(d.createStateProducerForGoals_10__15(5),[9,13]),d.state12(6)]}static createStateProducerForGoals_1_2(t){const e=new d(t);return e.goals=[1,2],e.lockedStateElements=[],e.state=[...d.stateDone],e.episodesToTrain=100,d.shuffle(e,e.lockedStateElements),e}static state1(t){return d.createStateProducer(1,t)}static createStateProducerForGoals_3_4(t){const e=new d(t);return e.goals=[3,4],e.lockedStateElements=[1,2],e.state=[...d.stateDone],e.episodesToTrain=100,d.shuffle(e,[1,2,3]),e}static createStateProducerForGoals_5_6(t){const e=new d(t);return e.goals=[5,6],e.lockedStateElements=[1,2,3,4],e.state=[...d.stateDone],e.episodesToTrain=100,d.shuffle(e,e.lockedStateElements),e}static createStateProducer(t,e){const n=new d(e);return n.goals=[t],n.lockedStateElements=Array.from({length:t-1},(s,r)=>r+1),n.state=[...d.stateDone],n.episodesToTrain=100,d.shuffle(n,n.lockedStateElements),n}static shuffleFreeCellStarPosition(t,e){const n=F.shuffleArray(e)[0],s=t.state.indexOf(-1),r=t.state[n];return t.state[n]=-1,t.state[s]=r,t}static createStateProducerForGoals_7_8(t){const e=new d(t);return e.goals=[7,8],e.lockedStateElements=[1,2,3,4,5,6],e.state=[...d.stateDone],e.episodesToTrain=100,d.shuffle(e,[1,2,3,4,5,6,7]),e}static createStateProducerForGoals_9_13(t){const e=new d(t);return e.goals=[9,13],e.lockedStateElements=[1,2,3,4,5,6,7,8],e.state=[...d.stateDone],e.episodesToTrain=100,d.shuffle(e,e.lockedStateElements),e}static createStateProducerForGoals_10__15(t){const e=new d(t);return e.goals=[10,11,14,15],e.lockedStateElements=[1,2,3,4,5,6,7,8,9,13],e.state=ie.shuffle([...d.stateDone],e.lockedStateElements,this.shufleSteps),e.episodesToTrain=100,e}static state12(t){const e=new d(t);return e.goals=[12],e.lockedStateElements=[1,2,3,4,5,6,7,8,9,10,11,13,14,15],e.state=ie.shuffle([...d.stateDone],e.lockedStateElements,this.shufleSteps),e.episodesToTrain=10,e}isLockedIndex(t){return this.lockedStateElements.includes(t+1)}static shuffle(t,e){let n=t.state.filter(s=>!e.includes(s));n=F.shuffleArray(n),t.state=[...e,...n]}resetState(){const t=d.generateLessons()[this.lessonNb];this.goals=[...t.goals],this.lockedStateElements=[...t.lockedStateElements],this.state=[...t.state]}};A(d,"stateDone",[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,-1]),A(d,"shufleSteps",100);let le=d;class Fe{constructor(t,e,n,s,r){A(this,"state");A(this,"action");A(this,"reward");A(this,"done");A(this,"newState");this.state=new J(t),this.action=e,this.reward=n,this.done=s,this.newState=new J(r)}getState(){return this.state}getAction(){return this.action}getReward(){return this.reward}isDone(){return this.done}getNewState(){return this.newState}equals(t){return t instanceof Fe?this.hashCode()===t.hashCode():!1}hashCode(){return this.state.getHashCodeV2()^this.newState.getHashCodeV2()}}class Ge{constructor(t){A(this,"state");A(this,"qValues");this.state=t,this.qValues=new Map}setValue(t,e){const n=ee.getPossibleActions(this.state);this.qValues.size===0&&n.forEach(s=>this.qValues.set(s,0)),n.includes(t)&&this.qValues.set(t,e)}getState(){return this.state}getValue(t){return this.qValues.get(t)||0}getActionWithMaxValue(t){const e=ee.getPossibleActions(this.state).filter(s=>s!==t),n=t===null?null:this.getAction(t);return n??(e.length>0?e[0]:w.D)}getAction(t){const n=Array.from(this.qValues.entries()).filter(([s])=>s!==t).reduce((s,r)=>r[1]>s[1]?r:s,[t,-1/0]);return n[1]>-1/0?n[0]:void 0}getMaxValue(){return this.qValues.size===0?0:Math.max(...Array.from(this.qValues.values()))}}class Oe{static updateQTable(t,e,n,s,r,p,o,h){let x;if(p)x=r;else{const L=this.getQValue(t,e,n),D=this.getMaxQValue(t,s);x=this.calcQValue(r,L,D,h,o)}this.addStateWithZeroValuesToQTableIfStateNotExist(t,e),this.updateQTableEntry(t,e.getHashCodeV2(),n,x)}static updateQTableEntry(t,e,n,s){var r;(r=t.get(e))==null||r.setValue(n,s)}static getMaxQValue(t,e){var s;const n=e.getHashCodeV2();return this.addStateWithZeroValuesToQTableIfStateNotExist(t,e),((s=t.get(n))==null?void 0:s.getMaxValue())??0}static getQValue(t,e,n){var r;const s=e.getHashCodeV2();return this.addStateWithZeroValuesToQTableIfStateNotExist(t,e),((r=t.get(s))==null?void 0:r.getValue(n))??0}static addStateWithZeroValuesToQTableIfStateNotExist(t,e){t.has(e.getHashCodeV2())||this.addStateWithZeroValuesToQTable(t,e)}static addStateWithZeroValuesToQTable(t,e){const n=e.getHashCodeV2(),s=new Ge(e);t.set(n,s)}static calcQValue(t,e,n,s,r){return e+r*(t+s*n-e)}}const ne=class ne{async runEpisode(t,e,n,s,r,p){if(!fe.semaphore.goodToGo(p))return;const o=new $e,h=new ee(t);h.reset();let x=h.getInitState();h.prntInfo();const L=.5;let D=!1,R=0;for(;!D&&R<50;){if(!fe.semaphore.goodToGo(p))return;R++;let z;const k=ee.getPossibleActions(x);if(h.reverseAction!==null){const c=k.indexOf(h.reverseAction);k.splice(c,1)}o.nextDouble()<L?(F.prnt(`
rndm move`),z=P.getRandomAction(k)):(F.prnt(`
qTable move`),z=P.getAction(e,x,h.reverseAction),k.includes(z)||(z=P.getAction(e,x,h.reverseAction))),F.prnt(`

------------------------------------------------------------------
`),F.prnt(`
action: `+z);const T=h.executeAction(x,z),I=T.state;h.prntInfo();const l=T.reward;D=T.isTerminal,D&&(D=!0);const i=new Fe(x,z,l,D,I);ne.experience.add(i),x=T.state}ne.replayExperience(ne.experience,e,s,n,1e4),ne.experience.size>1e4&&ne.experience.clear();const q=`QTable size: ${e.size}, experience size: ${ne.experience.size}`;F.prnt(`
`),F.prnt(r),F.prnt(q),Z.prntStatsInfo(q),await F.sleep(500),Z.clearScreen()}static replayExperience(t,e,n,s,r){Array.from(t).sort(()=>Math.random()-.5).slice(0,r).forEach(o=>{Oe.updateQTable(e,o.getState(),o.getAction(),o.getNewState(),o.getReward(),o.isDone(),n,s)})}};A(ne,"experience",new Set);let ve=ne;class $e{nextDouble(){return Math.random()}}class Le{constructor(){A(this,"enabled",!0);A(this,"id",0)}enable(){return this.id++,this.enabled=!0,this.id}disable(){this.enabled=!1}isEnabled(){return this.enabled}goodToGo(t){return!(!this.enabled||t!==this.id)}}const ue=class ue{constructor(){A(this,"episodeRunner",new ve);A(this,"semaphoreId",null)}async train(t,e){if(this.semaphoreId=ue.semaphore.enable(),!ue.semaphore.goodToGo(this.semaphoreId))return;ve.experience.clear();const n=.9,s=.1,r=await le.getStateProducersFromJson(),p=async(h,x)=>{await this.episodeRunner.runEpisode(h,t,n,s,x,this.semaphoreId)},o=async(h,x)=>{let L=h.getEpisodesToTrain();for(let D=0;D<L;D++){let R="Episode: "+(D+1)+" of "+L+`
`+x;await p(h,R)}};for(let h=0;h<e;h++){let x="Running training batch: "+(h+1)+" of "+e;await Promise.all(r.map(L=>o(L,x)))}F.prnt("training done")}stop(){ue.semaphore.disable()}};A(ue,"semaphore",new Le);let fe=ue;class Ce{static async getQTableActionMap(){const t="dist/qTableActions.csv",e="/public/qTableActions.csv";let n=await ye.getFile(t);n=n===""?await ye.getFile(e):n;const s=n.trim().split(`
`),r=new Map;return s.forEach(p=>{const[o,h]=p.trim().split(",");r.set(o,w[h])}),r}static getStateActionKey(t){const e=t.getState(),n=t.getGoals();return Array.from({length:16},(r,p)=>{let o;const h=e[p];return h===-1?o="*":n.includes(h)?o=`${h}`:n.includes(p+1)?o="o":o=" ",o+="_",p!==0&&(p+1)%4===0&&(o+="|"),o}).join("").trim()}}const V=class V{constructor(){A(this,"semaphoreId",null)}async test(){if(V.usePreloadedActions&&V.actionMap===null&&(V.actionMap=await Ce.getQTableActionMap()),this.semaphoreId=V.semaphore.enable(),!V.semaphore.goodToGo(this.semaphoreId))return;const t=oe.qTable,e=V.getStatistics(t);for(F.prnt(e);;){if(!V.semaphore.goodToGo(this.semaphoreId))return;await this.testQTable(t)}}stop(){V.semaphore.disable()}async testQTable(t){if(!V.semaphore.goodToGo(this.semaphoreId))return;let e=0;const n=le.generateLessons(),s=n.length;let r=n[e],p=ie.shuffle(le.stateDone,[],1e3),o=new J(p,r),h=r.getGoals();Z.clearScreen(),P.zenGardenOn||F.prnt(`0
----
`),V.prntState(o);let x=!1,L=0,D=null;for(;!x&&L<200;){if(!V.semaphore.goodToGo(this.semaphoreId))return;L++;let q=this.getAction(t,o,D);D=P.getReverseAction(q);const z=P.makeMove(o.getState(),q),k=ee._isTerminalSuccess(z,h);o=new J(z,r),x=F.equalArrays(o.getState(),le.stateDone),await F.sleep(1e3/2),Z.clearScreen(),P.zenGardenOn||F.prnt(`${L}
----
`),V.prntState(o),k&&!x&&e<s-1&&(e++,r=n[e],h=r.getGoals(),o=new J(o.getState(),r))}const R=ee.isTerminalSuccess(o)?"success":"failed";P.zenGardenOn||F.prnt(`----
${R}`),await F.sleep(3e3)}getAction(t,e,n){var p;if(V.usePreloadedActions&&V.actionMap!==null&&V.actionMap.size>0){let o=Ce.getStateActionKey(e);if((p=V.actionMap)!=null&&p.has(o)){let h=V.actionMap.get(o);return!P.zenGardenOn&&h===void 0&&F.prnt("no action found"),h===void 0?P.getFirstPossibleActionOrD(e,n):h}}const s=e.getHashCodeV2();Oe.addStateWithZeroValuesToQTableIfStateNotExist(t,e);const r=t.get(s);return r?r.getActionWithMaxValue(n):(P.zenGardenOn||F.prnt("no action found"),P.getFirstPossibleActionOrD(e,n))}static prntState(t){P.prntState(t.getState(),t.getGoals())}static getStatistics(t){const e=Array.from(t.values()).flatMap(o=>Array.from(o.qValues.values())),n=e.reduce((o,h)=>o+h,0),s=e.length,r=s?n/s:0,p=new Ne;return p.count=s,p.sum=n,p.average=r,p}};A(V,"semaphore",new Le),A(V,"usePreloadedActions",!0),A(V,"actionMap",null);let we=V;class Ne{constructor(){A(this,"count",0);A(this,"sum",0);A(this,"average",0)}}const de=class de{static async train(){this.trainer=new fe,await this.trainer.train(de.qTable,10)}static async test(){this.tester=new we,await this.tester.test()}static async stopTrainer(){var t;(t=this.trainer)==null||t.stop()}static async stopTester(){var t;(t=this.tester)==null||t.stop()}};A(de,"qTable",new Map),A(de,"trainer",null),A(de,"tester",null);let oe=de;const Re=window;function He(m,t,e={}){const n={tab:"	",indentOn:/[({\[]$/,moveToNewLine:/^[)}\]]/,spellcheck:!1,catchTab:!0,preserveIdent:!0,addClosing:!0,history:!0,window:Re,...e},s=n.window,r=s.document,p=[],o=[];let h=-1,x=!1,L=()=>{},D;m.setAttribute("contenteditable","plaintext-only"),m.setAttribute("spellcheck",n.spellcheck?"true":"false"),m.style.outline="none",m.style.overflowWrap="break-word",m.style.overflowY="auto",m.style.whiteSpace="pre-wrap";const R=(a,u)=>{t(a,u)};let q=!1;m.contentEditable!=="plaintext-only"&&(q=!0),q&&m.setAttribute("contenteditable","true");const z=me(()=>{const a=i();R(m,a),c(a)},30);let k=!1;const T=a=>!G(a)&&!B(a)&&a.key!=="Meta"&&a.key!=="Control"&&a.key!=="Alt"&&!a.key.startsWith("Arrow"),I=me(a=>{T(a)&&(Y(),k=!1)},300),l=(a,u)=>{p.push([a,u]),m.addEventListener(a,u)};l("keydown",a=>{a.defaultPrevented||(D=W(),n.preserveIdent?E(a):S(a),n.catchTab&&H(a),n.addClosing&&M(a),n.history&&(X(a),T(a)&&!k&&(Y(),k=!0)),q&&!se(a)&&c(i()))}),l("keyup",a=>{a.defaultPrevented||a.isComposing||(D!==W()&&z(),I(a),L(W()))}),l("focus",a=>{x=!0}),l("blur",a=>{x=!1}),l("paste",a=>{Y(),he(a),Y(),L(W())}),l("cut",a=>{Y(),Ae(a),Y(),L(W())});function i(){const a=Q(),u={start:0,end:0,dir:void 0};let{anchorNode:y,anchorOffset:b,focusNode:C,focusOffset:O}=a;if(!y||!C)throw"error1";if(y===m&&C===m)return u.start=b>0&&m.textContent?m.textContent.length:0,u.end=O>0&&m.textContent?m.textContent.length:0,u.dir=O>=b?"->":"<-",u;if(y.nodeType===Node.ELEMENT_NODE){const N=r.createTextNode("");y.insertBefore(N,y.childNodes[b]),y=N,b=0}if(C.nodeType===Node.ELEMENT_NODE){const N=r.createTextNode("");C.insertBefore(N,C.childNodes[O]),C=N,O=0}return pe(m,N=>{if(N===y&&N===C)return u.start+=b,u.end+=O,u.dir=b<=O?"->":"<-","stop";if(N===y)if(u.start+=b,!u.dir)u.dir="->";else return"stop";else if(N===C)if(u.end+=O,!u.dir)u.dir="<-";else return"stop";N.nodeType===Node.TEXT_NODE&&(u.dir!="->"&&(u.start+=N.nodeValue.length),u.dir!="<-"&&(u.end+=N.nodeValue.length))}),m.normalize(),u}function c(a){var Ee,Te;const u=Q();let y,b=0,C,O=0;if(a.dir||(a.dir="->"),a.start<0&&(a.start=0),a.end<0&&(a.end=0),a.dir=="<-"){const{start:_,end:te}=a;a.start=te,a.end=_}let N=0;pe(m,_=>{if(_.nodeType!==Node.TEXT_NODE)return;const te=(_.nodeValue||"").length;if(N+te>a.start&&(y||(y=_,b=a.start-N),N+te>a.end))return C=_,O=a.end-N,"stop";N+=te}),y||(y=m,b=m.childNodes.length),C||(C=m,O=m.childNodes.length),a.dir=="<-"&&([y,b,C,O]=[C,O,y,b]);{const _=g(y);if(_){const ge=r.createTextNode("");(Ee=_.parentNode)==null||Ee.insertBefore(ge,_),y=ge,b=0}const te=g(C);if(te){const ge=r.createTextNode("");(Te=te.parentNode)==null||Te.insertBefore(ge,te),C=ge,O=0}}u.setBaseAndExtent(y,b,C,O),m.normalize()}function g(a){for(;a&&a!==m;){if(a.nodeType===Node.ELEMENT_NODE){const u=a;if(u.getAttribute("contenteditable")=="false")return u}a=a.parentNode}}function f(){const u=Q().getRangeAt(0),y=r.createRange();return y.selectNodeContents(m),y.setEnd(u.startContainer,u.startOffset),y.toString()}function v(){const u=Q().getRangeAt(0),y=r.createRange();return y.selectNodeContents(m),y.setStart(u.endContainer,u.endOffset),y.toString()}function E(a){if(a.key==="Enter"){const u=f(),y=v();let[b]=K(u),C=b;if(n.indentOn.test(u)&&(C+=n.tab),C.length>0?(U(a),a.stopPropagation(),$(`
`+C)):S(a),C!==b&&n.moveToNewLine.test(y)){const O=i();$(`
`+b),c(O)}}}function S(a){if(q&&a.key==="Enter")if(U(a),a.stopPropagation(),v()==""){$(`
 `);const u=i();u.start=--u.end,c(u)}else $(`
`)}function M(a){const u=`([{'"`,y=`)]}'"`;if(u.includes(a.key)){U(a);const b=i(),C=b.start==b.end?"":Q().toString(),O=a.key+C+y[u.indexOf(a.key)];$(O),b.start++,b.end++,c(b)}}function H(a){if(a.key==="Tab")if(U(a),a.shiftKey){const u=f();let[y,b]=K(u);if(y.length>0){const C=i(),O=Math.min(n.tab.length,y.length);c({start:b,end:b+O}),r.execCommand("delete"),C.start-=O,C.end-=O,c(C)}}else $(n.tab)}function X(a){if(G(a)){U(a),h--;const u=o[h];u&&(m.innerHTML=u.html,c(u.pos)),h<0&&(h=0)}if(B(a)){U(a),h++;const u=o[h];u&&(m.innerHTML=u.html,c(u.pos)),h>=o.length&&h--}}function Y(){if(!x)return;const a=m.innerHTML,u=i(),y=o[h];if(y&&y.html===a&&y.pos.start===u.start&&y.pos.end===u.end)return;h++,o[h]={html:a,pos:u},o.splice(h+1);const b=300;h>b&&(h=b,o.splice(0,1))}function he(a){if(a.defaultPrevented)return;U(a);const y=(a.originalEvent??a).clipboardData.getData("text/plain").replace(/\r\n?/g,`
`),b=i();$(y),R(m),c({start:Math.min(b.start,b.end)+y.length,end:Math.min(b.start,b.end)+y.length,dir:"<-"})}function Ae(a){const u=i(),y=Q();(a.originalEvent??a).clipboardData.setData("text/plain",y.toString()),r.execCommand("delete"),R(m),c({start:Math.min(u.start,u.end),end:Math.min(u.start,u.end),dir:"<-"}),U(a)}function pe(a,u){const y=[];a.firstChild&&y.push(a.firstChild);let b=y.pop();for(;b&&u(b)!=="stop";)b.nextSibling&&y.push(b.nextSibling),b.firstChild&&y.push(b.firstChild),b=y.pop()}function ce(a){return a.metaKey||a.ctrlKey}function G(a){return ce(a)&&!a.shiftKey&&ae(a)==="Z"}function B(a){return ce(a)&&a.shiftKey&&ae(a)==="Z"}function se(a){return ce(a)&&ae(a)==="C"}function ae(a){let u=a.key||a.keyCode||a.which;if(u)return(typeof u=="string"?u:String.fromCharCode(u)).toUpperCase()}function $(a){a=a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),r.execCommand("insertHTML",!1,a)}function me(a,u){let y=0;return(...b)=>{clearTimeout(y),y=s.setTimeout(()=>a(...b),u)}}function K(a){let u=a.length-1;for(;u>=0&&a[u]!==`
`;)u--;u++;let y=u;for(;y<a.length&&/[ \t]/.test(a[y]);)y++;return[a.substring(u,y)||"",u,y]}function W(){return m.textContent||""}function U(a){a.preventDefault()}function Q(){var a;return((a=m.parentNode)==null?void 0:a.nodeType)==Node.DOCUMENT_FRAGMENT_NODE?m.parentNode.getSelection():s.getSelection()}return{updateOptions(a){Object.assign(n,a)},updateCode(a){m.textContent=a,R(m),L(a)},onUpdate(a){L=a},toString:W,save:i,restore:c,recordHistory:Y,destroy(){for(let[a,u]of p)m.removeEventListener(a,u)}}}var ke=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Me={exports:{}};(function(m){var t=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var e=function(n){var s=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,r=0,p={},o={manual:n.Prism&&n.Prism.manual,disableWorkerMessageHandler:n.Prism&&n.Prism.disableWorkerMessageHandler,util:{encode:function l(i){return i instanceof h?new h(i.type,l(i.content),i.alias):Array.isArray(i)?i.map(l):i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(l){return Object.prototype.toString.call(l).slice(8,-1)},objId:function(l){return l.__id||Object.defineProperty(l,"__id",{value:++r}),l.__id},clone:function l(i,c){c=c||{};var g,f;switch(o.util.type(i)){case"Object":if(f=o.util.objId(i),c[f])return c[f];g={},c[f]=g;for(var v in i)i.hasOwnProperty(v)&&(g[v]=l(i[v],c));return g;case"Array":return f=o.util.objId(i),c[f]?c[f]:(g=[],c[f]=g,i.forEach(function(E,S){g[S]=l(E,c)}),g);default:return i}},getLanguage:function(l){for(;l;){var i=s.exec(l.className);if(i)return i[1].toLowerCase();l=l.parentElement}return"none"},setLanguage:function(l,i){l.className=l.className.replace(RegExp(s,"gi"),""),l.classList.add("language-"+i)},currentScript:function(){if(typeof document>"u")return null;if("currentScript"in document)return document.currentScript;try{throw new Error}catch(g){var l=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(g.stack)||[])[1];if(l){var i=document.getElementsByTagName("script");for(var c in i)if(i[c].src==l)return i[c]}return null}},isActive:function(l,i,c){for(var g="no-"+i;l;){var f=l.classList;if(f.contains(i))return!0;if(f.contains(g))return!1;l=l.parentElement}return!!c}},languages:{plain:p,plaintext:p,text:p,txt:p,extend:function(l,i){var c=o.util.clone(o.languages[l]);for(var g in i)c[g]=i[g];return c},insertBefore:function(l,i,c,g){g=g||o.languages;var f=g[l],v={};for(var E in f)if(f.hasOwnProperty(E)){if(E==i)for(var S in c)c.hasOwnProperty(S)&&(v[S]=c[S]);c.hasOwnProperty(E)||(v[E]=f[E])}var M=g[l];return g[l]=v,o.languages.DFS(o.languages,function(H,X){X===M&&H!=l&&(this[H]=v)}),v},DFS:function l(i,c,g,f){f=f||{};var v=o.util.objId;for(var E in i)if(i.hasOwnProperty(E)){c.call(i,E,i[E],g||E);var S=i[E],M=o.util.type(S);M==="Object"&&!f[v(S)]?(f[v(S)]=!0,l(S,c,null,f)):M==="Array"&&!f[v(S)]&&(f[v(S)]=!0,l(S,c,E,f))}}},plugins:{},highlightAll:function(l,i){o.highlightAllUnder(document,l,i)},highlightAllUnder:function(l,i,c){var g={callback:c,container:l,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};o.hooks.run("before-highlightall",g),g.elements=Array.prototype.slice.apply(g.container.querySelectorAll(g.selector)),o.hooks.run("before-all-elements-highlight",g);for(var f=0,v;v=g.elements[f++];)o.highlightElement(v,i===!0,g.callback)},highlightElement:function(l,i,c){var g=o.util.getLanguage(l),f=o.languages[g];o.util.setLanguage(l,g);var v=l.parentElement;v&&v.nodeName.toLowerCase()==="pre"&&o.util.setLanguage(v,g);var E=l.textContent,S={element:l,language:g,grammar:f,code:E};function M(X){S.highlightedCode=X,o.hooks.run("before-insert",S),S.element.innerHTML=S.highlightedCode,o.hooks.run("after-highlight",S),o.hooks.run("complete",S),c&&c.call(S.element)}if(o.hooks.run("before-sanity-check",S),v=S.element.parentElement,v&&v.nodeName.toLowerCase()==="pre"&&!v.hasAttribute("tabindex")&&v.setAttribute("tabindex","0"),!S.code){o.hooks.run("complete",S),c&&c.call(S.element);return}if(o.hooks.run("before-highlight",S),!S.grammar){M(o.util.encode(S.code));return}if(i&&n.Worker){var H=new Worker(o.filename);H.onmessage=function(X){M(X.data)},H.postMessage(JSON.stringify({language:S.language,code:S.code,immediateClose:!0}))}else M(o.highlight(S.code,S.grammar,S.language))},highlight:function(l,i,c){var g={code:l,grammar:i,language:c};if(o.hooks.run("before-tokenize",g),!g.grammar)throw new Error('The language "'+g.language+'" has no grammar.');return g.tokens=o.tokenize(g.code,g.grammar),o.hooks.run("after-tokenize",g),h.stringify(o.util.encode(g.tokens),g.language)},tokenize:function(l,i){var c=i.rest;if(c){for(var g in c)i[g]=c[g];delete i.rest}var f=new D;return R(f,f.head,l),L(l,f,i,f.head,0),z(f)},hooks:{all:{},add:function(l,i){var c=o.hooks.all;c[l]=c[l]||[],c[l].push(i)},run:function(l,i){var c=o.hooks.all[l];if(!(!c||!c.length))for(var g=0,f;f=c[g++];)f(i)}},Token:h};n.Prism=o;function h(l,i,c,g){this.type=l,this.content=i,this.alias=c,this.length=(g||"").length|0}h.stringify=function l(i,c){if(typeof i=="string")return i;if(Array.isArray(i)){var g="";return i.forEach(function(M){g+=l(M,c)}),g}var f={type:i.type,content:l(i.content,c),tag:"span",classes:["token",i.type],attributes:{},language:c},v=i.alias;v&&(Array.isArray(v)?Array.prototype.push.apply(f.classes,v):f.classes.push(v)),o.hooks.run("wrap",f);var E="";for(var S in f.attributes)E+=" "+S+'="'+(f.attributes[S]||"").replace(/"/g,"&quot;")+'"';return"<"+f.tag+' class="'+f.classes.join(" ")+'"'+E+">"+f.content+"</"+f.tag+">"};function x(l,i,c,g){l.lastIndex=i;var f=l.exec(c);if(f&&g&&f[1]){var v=f[1].length;f.index+=v,f[0]=f[0].slice(v)}return f}function L(l,i,c,g,f,v){for(var E in c)if(!(!c.hasOwnProperty(E)||!c[E])){var S=c[E];S=Array.isArray(S)?S:[S];for(var M=0;M<S.length;++M){if(v&&v.cause==E+","+M)return;var H=S[M],X=H.inside,Y=!!H.lookbehind,he=!!H.greedy,Ae=H.alias;if(he&&!H.pattern.global){var pe=H.pattern.toString().match(/[imsuy]*$/)[0];H.pattern=RegExp(H.pattern.source,pe+"g")}for(var ce=H.pattern||H,G=g.next,B=f;G!==i.tail&&!(v&&B>=v.reach);B+=G.value.length,G=G.next){var se=G.value;if(i.length>l.length)return;if(!(se instanceof h)){var ae=1,$;if(he){if($=x(ce,B,l,Y),!$||$.index>=l.length)break;var U=$.index,me=$.index+$[0].length,K=B;for(K+=G.value.length;U>=K;)G=G.next,K+=G.value.length;if(K-=G.value.length,B=K,G.value instanceof h)continue;for(var W=G;W!==i.tail&&(K<me||typeof W.value=="string");W=W.next)ae++,K+=W.value.length;ae--,se=l.slice(B,K),$.index-=B}else if($=x(ce,0,se,Y),!$)continue;var U=$.index,Q=$[0],a=se.slice(0,U),u=se.slice(U+Q.length),y=B+se.length;v&&y>v.reach&&(v.reach=y);var b=G.prev;a&&(b=R(i,b,a),B+=a.length),q(i,b,ae);var C=new h(E,X?o.tokenize(Q,X):Q,Ae,Q);if(G=R(i,b,C),u&&R(i,G,u),ae>1){var O={cause:E+","+M,reach:y};L(l,i,c,G.prev,B,O),v&&O.reach>v.reach&&(v.reach=O.reach)}}}}}}function D(){var l={value:null,prev:null,next:null},i={value:null,prev:l,next:null};l.next=i,this.head=l,this.tail=i,this.length=0}function R(l,i,c){var g=i.next,f={value:c,prev:i,next:g};return i.next=f,g.prev=f,l.length++,f}function q(l,i,c){for(var g=i.next,f=0;f<c&&g!==l.tail;f++)g=g.next;i.next=g,g.prev=i,l.length-=f}function z(l){for(var i=[],c=l.head.next;c!==l.tail;)i.push(c.value),c=c.next;return i}if(!n.document)return n.addEventListener&&(o.disableWorkerMessageHandler||n.addEventListener("message",function(l){var i=JSON.parse(l.data),c=i.language,g=i.code,f=i.immediateClose;n.postMessage(o.highlight(g,o.languages[c],c)),f&&n.close()},!1)),o;var k=o.util.currentScript();k&&(o.filename=k.src,k.hasAttribute("data-manual")&&(o.manual=!0));function T(){o.manual||o.highlightAll()}if(!o.manual){var I=document.readyState;I==="loading"||I==="interactive"&&k&&k.defer?document.addEventListener("DOMContentLoaded",T):window.requestAnimationFrame?window.requestAnimationFrame(T):window.setTimeout(T,16)}return o}(t);m.exports&&(m.exports=e),typeof ke<"u"&&(ke.Prism=e),e.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},e.languages.markup.tag.inside["attr-value"].inside.entity=e.languages.markup.entity,e.languages.markup.doctype.inside["internal-subset"].inside=e.languages.markup,e.hooks.add("wrap",function(n){n.type==="entity"&&(n.attributes.title=n.content.replace(/&amp;/,"&"))}),Object.defineProperty(e.languages.markup.tag,"addInlined",{value:function(s,r){var p={};p["language-"+r]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:e.languages[r]},p.cdata=/^<!\[CDATA\[|\]\]>$/i;var o={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:p}};o["language-"+r]={pattern:/[\s\S]+/,inside:e.languages[r]};var h={};h[s]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return s}),"i"),lookbehind:!0,greedy:!0,inside:o},e.languages.insertBefore("markup","cdata",h)}}),Object.defineProperty(e.languages.markup.tag,"addAttribute",{value:function(n,s){e.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+n+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[s,"language-"+s],inside:e.languages[s]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),e.languages.html=e.languages.markup,e.languages.mathml=e.languages.markup,e.languages.svg=e.languages.markup,e.languages.xml=e.languages.extend("markup",{}),e.languages.ssml=e.languages.xml,e.languages.atom=e.languages.xml,e.languages.rss=e.languages.xml,function(n){var s=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;n.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+s.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+s.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+s.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+s.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:s,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},n.languages.css.atrule.inside.rest=n.languages.css;var r=n.languages.markup;r&&(r.tag.addInlined("style","css"),r.tag.addAttribute("style","css"))}(e),e.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},e.languages.javascript=e.languages.extend("clike",{"class-name":[e.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),e.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,e.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:e.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:e.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:e.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:e.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:e.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),e.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:e.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),e.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),e.languages.markup&&(e.languages.markup.tag.addInlined("script","javascript"),e.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),e.languages.js=e.languages.javascript,function(){if(typeof e>"u"||typeof document>"u")return;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var n="Loading…",s=function(k,T){return"✖ Error "+k+" while fetching file: "+T},r="✖ Error: File does not exist or is empty",p={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},o="data-src-status",h="loading",x="loaded",L="failed",D="pre[data-src]:not(["+o+'="'+x+'"]):not(['+o+'="'+h+'"])';function R(k,T,I){var l=new XMLHttpRequest;l.open("GET",k,!0),l.onreadystatechange=function(){l.readyState==4&&(l.status<400&&l.responseText?T(l.responseText):l.status>=400?I(s(l.status,l.statusText)):I(r))},l.send(null)}function q(k){var T=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(k||"");if(T){var I=Number(T[1]),l=T[2],i=T[3];return l?i?[I,Number(i)]:[I,void 0]:[I,I]}}e.hooks.add("before-highlightall",function(k){k.selector+=", "+D}),e.hooks.add("before-sanity-check",function(k){var T=k.element;if(T.matches(D)){k.code="",T.setAttribute(o,h);var I=T.appendChild(document.createElement("CODE"));I.textContent=n;var l=T.getAttribute("data-src"),i=k.language;if(i==="none"){var c=(/\.(\w+)$/.exec(l)||[,"none"])[1];i=p[c]||c}e.util.setLanguage(I,i),e.util.setLanguage(T,i);var g=e.plugins.autoloader;g&&g.loadLanguages(i),R(l,function(f){T.setAttribute(o,x);var v=q(T.getAttribute("data-range"));if(v){var E=f.split(/\r\n?|\n/g),S=v[0],M=v[1]==null?E.length:v[1];S<0&&(S+=E.length),S=Math.max(0,Math.min(S-1,E.length)),M<0&&(M+=E.length),M=Math.max(0,Math.min(M,E.length)),f=E.slice(S,M).join(`
`),T.hasAttribute("data-start")||T.setAttribute("data-start",String(S+1))}I.textContent=f,e.highlightElement(I)},function(f){T.setAttribute(o,L),I.textContent=f})}}),e.plugins.fileHighlight={highlight:function(T){for(var I=(T||document).querySelectorAll(D),l=0,i;i=I[l++];)e.highlightElement(i)}};var z=!1;e.fileHighlight=function(){z||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),z=!0),e.plugins.fileHighlight.highlight.apply(this,arguments)}}()})(Me);var Pe=Me.exports;class ze{static async toggleLessonsDisplay(t){var n;const e=document.getElementById("tools");if(t&&e){const s=await Se.getLessonsJson(),r=document.createElement("div");e.appendChild(r),r.id="lessons",He(r,o=>{o.textContent!==null&&(o.innerHTML=Pe.highlight(o.textContent,Pe.languages.js,"js"))}).updateCode(s)}else(n=document.getElementById("lessons"))==null||n.remove()}}class re{static setupTools(){var t,e,n,s,r;(t=document.getElementById("startTrainingBtn"))==null||t.addEventListener("click",()=>re.startTraining().then()),(e=document.getElementById("startTestingBtn"))==null||e.addEventListener("click",()=>re.startTesting().then()),(n=document.getElementById("pretrainedBtn"))==null||n.addEventListener("click",()=>re.usePretrainedOnOff().then()),(s=document.getElementById("zenGardenBtn"))==null||s.addEventListener("click",()=>re.zenGardenOnOff().then()),(r=document.getElementById("lessonsBtn"))==null||r.addEventListener("click",()=>re.lessonsOnOff().then()),this.startTesting().then()}static async startTraining(){oe.stopTester(),Z.clearScreen(),F.prnt("starting training session ... "),await F.sleep(0),oe.train().then(()=>re.startTesting().then())}static async startTesting(){oe.stopTrainer(),Z.clearScreen(),F.prnt("start testing ... "),await F.sleep(0),oe.test().then()}static async lessonsOnOff(){this.btnOnOff("lessonsBtn","show training lessons",t=>ze.toggleLessonsDisplay(t))}static async usePretrainedOnOff(){this.btnOnOff("pretrainedBtn","use pretrained",t=>we.usePreloadedActions=t)}static async zenGardenOnOff(){this.btnOnOff("zenGardenBtn","zen garden",t=>P.zenGardenOn=t)}static async btnOnOff(t,e,n){let s=document.getElementById(t);(s==null?void 0:s.getAttribute("value"))!==e+" off"?(s==null||s.setAttribute("value",e+" off"),n(!1)):(s==null||s.setAttribute("value",e+" on"),n(!0))}}re.setupTools();
